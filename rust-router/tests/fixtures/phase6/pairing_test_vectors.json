{
  "description": "Phase 6 Pairing Test Vectors",
  "version": "1.0.0",
  "generated": "2026-01-07",
  "test_vectors": [
    {
      "name": "valid_wg_unidirectional_pair_request",
      "description": "Valid WireGuard unidirectional pairing request",
      "input": {
        "local_tag": "node-a",
        "local_description": "Node A - Primary Gateway",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_wg_bidirectional_pair_request",
      "description": "Valid WireGuard bidirectional pairing request",
      "input": {
        "local_tag": "node-b",
        "local_description": "Node B - Secondary Gateway",
        "local_endpoint": "192.168.1.100:36201",
        "local_api_port": 36000,
        "bidirectional": true,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_xray_unidirectional_pair_request",
      "description": "Valid Xray unidirectional pairing request",
      "input": {
        "local_tag": "node-xray",
        "local_description": "Xray Node",
        "local_endpoint": "vpn.example.com:443",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "xray"
      },
      "expected": "success"
    },
    {
      "name": "valid_xray_bidirectional_pair_request",
      "description": "Valid Xray bidirectional pairing request",
      "input": {
        "local_tag": "xray-bi",
        "local_description": "Xray Bidirectional Node",
        "local_endpoint": "xray.example.com:443",
        "local_api_port": 36001,
        "bidirectional": true,
        "tunnel_type": "xray"
      },
      "expected": "success"
    },
    {
      "name": "valid_ipv6_endpoint",
      "description": "Valid pairing with IPv6 endpoint",
      "input": {
        "local_tag": "node-ipv6",
        "local_description": "IPv6 Node",
        "local_endpoint": "[2001:db8::1]:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_hostname_endpoint",
      "description": "Valid pairing with hostname endpoint",
      "input": {
        "local_tag": "node-dns",
        "local_description": "DNS Resolved Node",
        "local_endpoint": "peer.vpn.example.com:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "invalid_empty_tag",
      "description": "Empty tag should fail validation",
      "input": {
        "local_tag": "",
        "local_description": "Node with empty tag",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "EmptyTag"
    },
    {
      "name": "invalid_tag_too_long",
      "description": "Tag exceeding 64 characters should fail",
      "input": {
        "local_tag": "this-tag-is-way-too-long-and-exceeds-the-maximum-allowed-length-of-64-chars",
        "local_description": "Node with long tag",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "TagTooLong"
    },
    {
      "name": "invalid_tag_special_chars",
      "description": "Tag with invalid special characters",
      "input": {
        "local_tag": "node@invalid!",
        "local_description": "Node with special chars",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "InvalidTagCharacters"
    },
    {
      "name": "invalid_tag_starts_with_hyphen",
      "description": "Tag starting with hyphen should fail",
      "input": {
        "local_tag": "-invalid-start",
        "local_description": "Node starting with hyphen",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "InvalidTagStart"
    },
    {
      "name": "invalid_endpoint_no_port",
      "description": "Endpoint without port should fail",
      "input": {
        "local_tag": "node-noport",
        "local_description": "Node without port",
        "local_endpoint": "10.1.1.1",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "InvalidEndpoint"
    },
    {
      "name": "invalid_endpoint_port_zero",
      "description": "Endpoint with port 0 should fail",
      "input": {
        "local_tag": "node-port0",
        "local_description": "Node with port 0",
        "local_endpoint": "10.1.1.1:0",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "InvalidEndpoint"
    },
    {
      "name": "invalid_endpoint_empty",
      "description": "Empty endpoint should fail",
      "input": {
        "local_tag": "node-emptyep",
        "local_description": "Node with empty endpoint",
        "local_endpoint": "",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "InvalidEndpoint"
    },
    {
      "name": "invalid_api_port_zero",
      "description": "API port 0 should be invalid",
      "input": {
        "local_tag": "node-api0",
        "local_description": "Node with API port 0",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 0,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "InvalidPort"
    },
    {
      "name": "valid_min_tag_length",
      "description": "Single character tag should be valid",
      "input": {
        "local_tag": "a",
        "local_description": "Single char tag node",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_max_tag_length",
      "description": "64 character tag should be valid",
      "input": {
        "local_tag": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "local_description": "Max length tag node",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_tag_with_numbers",
      "description": "Tag with numbers should be valid",
      "input": {
        "local_tag": "node123-test456",
        "local_description": "Numeric tag node",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_tag_with_underscore",
      "description": "Tag with underscore should be valid",
      "input": {
        "local_tag": "node_a_test",
        "local_description": "Underscore tag node",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_high_port",
      "description": "High port number should be valid",
      "input": {
        "local_tag": "node-highport",
        "local_description": "High port node",
        "local_endpoint": "10.1.1.1:65535",
        "local_api_port": 65535,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "valid_description_max_length",
      "description": "Description at max length (256 chars)",
      "input": {
        "local_tag": "node-longdesc",
        "local_description": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "success"
    },
    {
      "name": "invalid_description_too_long",
      "description": "Description exceeding 256 characters",
      "input": {
        "local_tag": "node-toolong",
        "local_description": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": false,
        "tunnel_type": "wire_guard"
      },
      "expected": "error",
      "expected_error": "DescriptionTooLong"
    },
    {
      "name": "pair_request_round_trip",
      "description": "Test encode/decode round trip",
      "input": {
        "local_tag": "roundtrip-node",
        "local_description": "Round trip test",
        "local_endpoint": "10.1.1.1:36200",
        "local_api_port": 36000,
        "bidirectional": true,
        "tunnel_type": "wire_guard"
      },
      "expected": "success",
      "test_type": "round_trip"
    },
    {
      "name": "pair_response_valid",
      "description": "Valid pairing response",
      "input": {
        "request_node_tag": "node-a",
        "local_tag": "node-b",
        "local_description": "Response node",
        "local_endpoint": "10.1.1.2:36200",
        "local_api_port": 36000,
        "tunnel_type": "wire_guard",
        "tunnel_local_ip": "10.200.200.2",
        "tunnel_remote_ip": "10.200.200.1"
      },
      "expected": "success",
      "test_type": "response"
    }
  ]
}
