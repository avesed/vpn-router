{
  "version": "1.0",
  "description": "Rule matching test vectors for Rust/Python parity testing",
  "generated_at": "2026-01-05T21:02:51.016320Z",
  "total_cases": 510,
  "categories": {
    "domain_exact": 15,
    "domain_suffix": 16,
    "domain_keyword": 13,
    "domain_regex": 16,
    "geoip": 61,
    "port": 59,
    "protocol": 11,
    "priority": 7,
    "chain_routing": 6,
    "edge_case": 10,
    "real_world": 53,
    "combined": 23,
    "negative": 18,
    "stress": 3,
    "additional": 92
  },
  "test_cases": [
    {
      "id": "domain_exact_001",
      "category": "domain_exact",
      "description": "Exact match for google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_002",
      "category": "domain_exact",
      "description": "Exact match for facebook.com",
      "input": {
        "domain": "facebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "facebook.com",
          "outbound": "social"
        }
      ],
      "expected": {
        "outbound": "social",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_003",
      "category": "domain_exact",
      "description": "Exact match for twitter.com",
      "input": {
        "domain": "twitter.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "twitter.com",
          "outbound": "social"
        }
      ],
      "expected": {
        "outbound": "social",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_004",
      "category": "domain_exact",
      "description": "Exact match for github.com",
      "input": {
        "domain": "github.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "github.com",
          "outbound": "dev"
        }
      ],
      "expected": {
        "outbound": "dev",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_005",
      "category": "domain_exact",
      "description": "Exact match for stackoverflow.com",
      "input": {
        "domain": "stackoverflow.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "stackoverflow.com",
          "outbound": "dev"
        }
      ],
      "expected": {
        "outbound": "dev",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_006",
      "category": "domain_exact",
      "description": "Exact match for amazon.com",
      "input": {
        "domain": "amazon.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "amazon.com",
          "outbound": "shopping"
        }
      ],
      "expected": {
        "outbound": "shopping",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_007",
      "category": "domain_exact",
      "description": "Exact match for netflix.com",
      "input": {
        "domain": "netflix.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "netflix.com",
          "outbound": "streaming"
        }
      ],
      "expected": {
        "outbound": "streaming",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_008",
      "category": "domain_exact",
      "description": "Exact match for spotify.com",
      "input": {
        "domain": "spotify.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "spotify.com",
          "outbound": "streaming"
        }
      ],
      "expected": {
        "outbound": "streaming",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_case_001",
      "category": "domain_exact_case",
      "description": "Case insensitive exact match: GOOGLE.COM vs google.com",
      "input": {
        "domain": "GOOGLE.COM",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_case_002",
      "category": "domain_exact_case",
      "description": "Case insensitive exact match: Google.Com vs google.com",
      "input": {
        "domain": "Google.Com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_case_003",
      "category": "domain_exact_case",
      "description": "Case insensitive exact match: FACEBOOK.COM vs facebook.com",
      "input": {
        "domain": "FACEBOOK.COM",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "facebook.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_case_004",
      "category": "domain_exact_case",
      "description": "Case insensitive exact match: FaceBook.Com vs facebook.com",
      "input": {
        "domain": "FaceBook.Com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "facebook.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_exact_no_match_001",
      "category": "domain_exact_no_match",
      "description": "Subdomain should not match exact: www.google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_exact_no_match_002",
      "category": "domain_exact_no_match",
      "description": "Subdomain should not match exact: mail.google.com",
      "input": {
        "domain": "mail.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_exact_no_match_003",
      "category": "domain_exact_no_match",
      "description": "Subdomain should not match exact: api.github.com",
      "input": {
        "domain": "api.github.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "github.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_suffix_001",
      "category": "domain_suffix",
      "description": "Suffix match: www.google.com matches google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_002",
      "category": "domain_suffix",
      "description": "Suffix match: mail.google.com matches google.com",
      "input": {
        "domain": "mail.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_003",
      "category": "domain_suffix",
      "description": "Suffix match: google.com matches google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_004",
      "category": "domain_suffix",
      "description": "Suffix match: apis.google.com matches google.com",
      "input": {
        "domain": "apis.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_005",
      "category": "domain_suffix",
      "description": "Suffix match: m.facebook.com matches facebook.com",
      "input": {
        "domain": "m.facebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "facebook.com",
          "outbound": "social"
        }
      ],
      "expected": {
        "outbound": "social",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_006",
      "category": "domain_suffix",
      "description": "Suffix match: api.github.com matches github.com",
      "input": {
        "domain": "api.github.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "github.com",
          "outbound": "dev"
        }
      ],
      "expected": {
        "outbound": "dev",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_deep_001",
      "category": "domain_suffix_deep",
      "description": "Deep subdomain suffix match: very.deep.subdomain.google.com",
      "input": {
        "domain": "very.deep.subdomain.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_deep_002",
      "category": "domain_suffix_deep",
      "description": "Deep subdomain suffix match: s3.us-west-2.amazonaws.com",
      "input": {
        "domain": "s3.us-west-2.amazonaws.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazonaws.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_deep_003",
      "category": "domain_suffix_deep",
      "description": "Deep subdomain suffix match: cdnjs.cloudflare.com",
      "input": {
        "domain": "cdnjs.cloudflare.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cloudflare.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_boundary_001",
      "category": "domain_suffix_boundary",
      "description": "Suffix boundary: notgoogle.com should NOT match google.com",
      "input": {
        "domain": "notgoogle.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_suffix_boundary_002",
      "category": "domain_suffix_boundary",
      "description": "Suffix boundary: fakegoogle.com should NOT match google.com",
      "input": {
        "domain": "fakegoogle.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_suffix_boundary_003",
      "category": "domain_suffix_boundary",
      "description": "Suffix boundary: notfacebook.com should NOT match facebook.com",
      "input": {
        "domain": "notfacebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "facebook.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_suffix_boundary_004",
      "category": "domain_suffix_boundary",
      "description": "Suffix boundary: famazon.com should NOT match amazon.com",
      "input": {
        "domain": "famazon.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_suffix_leadingdot_001",
      "category": "domain_suffix_leading_dot",
      "description": "Leading dot handling: www.google.com vs .google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_leadingdot_002",
      "category": "domain_suffix_leading_dot",
      "description": "Leading dot handling: google.com vs .google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_suffix_leadingdot_003",
      "category": "domain_suffix_leading_dot",
      "description": "Leading dot handling: www.google.com vs google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_001",
      "category": "domain_keyword",
      "description": "Keyword match: google in google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "google",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_002",
      "category": "domain_keyword",
      "description": "Keyword match: google in www.google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "google",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_003",
      "category": "domain_keyword",
      "description": "Keyword match: google in googleapis.com",
      "input": {
        "domain": "googleapis.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "google",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_004",
      "category": "domain_keyword",
      "description": "Keyword match: ads in ads.example.com",
      "input": {
        "domain": "ads.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "ads",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_005",
      "category": "domain_keyword",
      "description": "Keyword match: tracking in tracking.example.com",
      "input": {
        "domain": "tracking.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "tracking",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_006",
      "category": "domain_keyword",
      "description": "Keyword match: facebook in facebook.com",
      "input": {
        "domain": "facebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "facebook",
          "outbound": "social"
        }
      ],
      "expected": {
        "outbound": "social",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_007",
      "category": "domain_keyword",
      "description": "Keyword match: facebook in connect.facebook.net",
      "input": {
        "domain": "connect.facebook.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "facebook",
          "outbound": "social"
        }
      ],
      "expected": {
        "outbound": "social",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_middle_001",
      "category": "domain_keyword_middle",
      "description": "Keyword in middle: ads in example-ads-server.com",
      "input": {
        "domain": "example-ads-server.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "ads",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_middle_002",
      "category": "domain_keyword_middle",
      "description": "Keyword in middle: track in track-analytics.example.com",
      "input": {
        "domain": "track-analytics.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "track",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_middle_003",
      "category": "domain_keyword_middle",
      "description": "Keyword in middle: cdn in cdn.example.com",
      "input": {
        "domain": "cdn.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "cdn",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_keyword_no_match_001",
      "category": "domain_keyword_no_match",
      "description": "No keyword match: facebook not in google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "facebook",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_keyword_no_match_002",
      "category": "domain_keyword_no_match",
      "description": "No keyword match: twitter not in amazon.com",
      "input": {
        "domain": "amazon.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "twitter",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_keyword_no_match_003",
      "category": "domain_keyword_no_match",
      "description": "No keyword match: youtube not in netflix.com",
      "input": {
        "domain": "netflix.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "youtube",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_regex_001",
      "category": "domain_regex",
      "description": "Regex match: .*\\.google\\.com$ vs www.google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.google\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_002",
      "category": "domain_regex",
      "description": "Regex match: .*\\.google\\.com$ vs mail.google.com",
      "input": {
        "domain": "mail.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.google\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_003",
      "category": "domain_regex",
      "description": "Regex match: .*\\.google\\.com$ vs google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.google\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_regex_004",
      "category": "domain_regex",
      "description": "Regex match: ^www\\..*\\.com$ vs www.example.com",
      "input": {
        "domain": "www.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": "^www\\..*\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_005",
      "category": "domain_regex",
      "description": "Regex match: ^www\\..*\\.com$ vs api.example.com",
      "input": {
        "domain": "api.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": "^www\\..*\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_regex_006",
      "category": "domain_regex",
      "description": "Regex match: .*\\.(cn|ru|ir)$ vs example.cn",
      "input": {
        "domain": "example.cn",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.(cn|ru|ir)$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_007",
      "category": "domain_regex",
      "description": "Regex match: .*\\.(cn|ru|ir)$ vs example.ru",
      "input": {
        "domain": "example.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.(cn|ru|ir)$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_008",
      "category": "domain_regex",
      "description": "Regex match: .*\\.(cn|ru|ir)$ vs example.ir",
      "input": {
        "domain": "example.ir",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.(cn|ru|ir)$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_009",
      "category": "domain_regex",
      "description": "Regex match: .*\\.(cn|ru|ir)$ vs example.com",
      "input": {
        "domain": "example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*\\.(cn|ru|ir)$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_regex_complex_001",
      "category": "domain_regex_complex",
      "description": "Complex regex: ^(www|api|cdn)\\.example\\.com$ vs www.example.com",
      "input": {
        "domain": "www.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": "^(www|api|cdn)\\.example\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_complex_002",
      "category": "domain_regex_complex",
      "description": "Complex regex: ^(www|api|cdn)\\.example\\.com$ vs api.example.com",
      "input": {
        "domain": "api.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": "^(www|api|cdn)\\.example\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_complex_003",
      "category": "domain_regex_complex",
      "description": "Complex regex: ^(www|api|cdn)\\.example\\.com$ vs cdn.example.com",
      "input": {
        "domain": "cdn.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": "^(www|api|cdn)\\.example\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_complex_004",
      "category": "domain_regex_complex",
      "description": "Complex regex: ^(www|api|cdn)\\.example\\.com$ vs mail.example.com",
      "input": {
        "domain": "mail.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": "^(www|api|cdn)\\.example\\.com$",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "domain_regex_complex_005",
      "category": "domain_regex_complex",
      "description": "Complex regex: .*-cdn[0-9]+\\..* vs static-cdn01.example.com",
      "input": {
        "domain": "static-cdn01.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*-cdn[0-9]+\\..*",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_complex_006",
      "category": "domain_regex_complex",
      "description": "Complex regex: .*-cdn[0-9]+\\..* vs static-cdn123.example.com",
      "input": {
        "domain": "static-cdn123.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*-cdn[0-9]+\\..*",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_regex_complex_007",
      "category": "domain_regex_complex",
      "description": "Complex regex: .*-cdn[0-9]+\\..* vs static-server.example.com",
      "input": {
        "domain": "static-server.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_regex",
          "target": ".*-cdn[0-9]+\\..*",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_private_001",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 10.0.0.1 in 10.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "10.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_002",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 10.255.255.255 in 10.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "10.255.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_003",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 10.100.50.25 in 10.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "10.100.50.25",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_004",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 172.16.0.1 in 172.16.0.0/12",
      "input": {
        "domain": null,
        "dest_ip": "172.16.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.16.0.0/12",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_005",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 172.31.255.255 in 172.16.0.0/12",
      "input": {
        "domain": null,
        "dest_ip": "172.31.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.16.0.0/12",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_006",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 172.20.100.50 in 172.16.0.0/12",
      "input": {
        "domain": null,
        "dest_ip": "172.20.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.16.0.0/12",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_007",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 192.168.0.1 in 192.168.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "192.168.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_008",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 192.168.255.255 in 192.168.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "192.168.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_private_009",
      "category": "geoip_cidr_private",
      "description": "Private IPv4 CIDR match: 192.168.1.100 in 192.168.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "192.168.1.100",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_boundary_001",
      "category": "geoip_cidr_boundary",
      "description": "CIDR boundary: 11.0.0.1 NOT in 10.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "11.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_boundary_002",
      "category": "geoip_cidr_boundary",
      "description": "CIDR boundary: 9.255.255.255 NOT in 10.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "9.255.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_boundary_003",
      "category": "geoip_cidr_boundary",
      "description": "CIDR boundary: 172.32.0.1 NOT in 172.16.0.0/12",
      "input": {
        "domain": null,
        "dest_ip": "172.32.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.16.0.0/12",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_boundary_004",
      "category": "geoip_cidr_boundary",
      "description": "CIDR boundary: 172.15.255.255 NOT in 172.16.0.0/12",
      "input": {
        "domain": null,
        "dest_ip": "172.15.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.16.0.0/12",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_boundary_005",
      "category": "geoip_cidr_boundary",
      "description": "CIDR boundary: 192.169.0.1 NOT in 192.168.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "192.169.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_boundary_006",
      "category": "geoip_cidr_boundary",
      "description": "CIDR boundary: 192.167.255.255 NOT in 192.168.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "192.167.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_single_001",
      "category": "geoip_cidr_single",
      "description": "Single host CIDR: 8.8.8.8 vs 8.8.8.8/32",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.8.8/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_single_002",
      "category": "geoip_cidr_single",
      "description": "Single host CIDR: 8.8.8.9 vs 8.8.8.8/32",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.9",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.8.8/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_single_003",
      "category": "geoip_cidr_single",
      "description": "Single host CIDR: 1.1.1.1 vs 1.1.1.1/32",
      "input": {
        "domain": null,
        "dest_ip": "1.1.1.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "1.1.1.1/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_single_004",
      "category": "geoip_cidr_single",
      "description": "Single host CIDR: 1.1.1.2 vs 1.1.1.1/32",
      "input": {
        "domain": null,
        "dest_ip": "1.1.1.2",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "1.1.1.1/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_prefix_001",
      "category": "geoip_cidr_prefix",
      "description": "CIDR prefix length: 8.1.2.3 vs 8.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "8.1.2.3",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.0.0.0/8",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_prefix_002",
      "category": "geoip_cidr_prefix",
      "description": "CIDR prefix length: 8.8.1.2 vs 8.8.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "8.8.1.2",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.0.0/16",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_prefix_003",
      "category": "geoip_cidr_prefix",
      "description": "CIDR prefix length: 8.8.8.1 vs 8.8.8.0/24",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.8.0/24",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_prefix_004",
      "category": "geoip_cidr_prefix",
      "description": "CIDR prefix length: 8.8.9.1 vs 8.8.8.0/24",
      "input": {
        "domain": null,
        "dest_ip": "8.8.9.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.8.0/24",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_ipv6_001",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: 2001:db8::1 vs 2001:db8::/32",
      "input": {
        "domain": null,
        "dest_ip": "2001:db8::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2001:db8::/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_ipv6_002",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff vs 2001:db8::/32",
      "input": {
        "domain": null,
        "dest_ip": "2001:db8:ffff:ffff:ffff:ffff:ffff:ffff",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2001:db8::/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_ipv6_003",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: 2001:db9::1 vs 2001:db8::/32",
      "input": {
        "domain": null,
        "dest_ip": "2001:db9::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2001:db8::/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_ipv6_004",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: fe80::1 vs fe80::/10",
      "input": {
        "domain": null,
        "dest_ip": "fe80::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "fe80::/10",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_ipv6_005",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: fe81::1 vs fe80::/10",
      "input": {
        "domain": null,
        "dest_ip": "fe81::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "fe80::/10",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_ipv6_006",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: fec0::1 vs fe80::/10",
      "input": {
        "domain": null,
        "dest_ip": "fec0::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "fe80::/10",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_ipv6_007",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: ::1 vs ::1/128",
      "input": {
        "domain": null,
        "dest_ip": "::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "::1/128",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_ipv6_008",
      "category": "geoip_cidr_ipv6",
      "description": "IPv6 CIDR: ::2 vs ::1/128",
      "input": {
        "domain": null,
        "dest_ip": "::2",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "::1/128",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_localhost_001",
      "category": "geoip_cidr_localhost",
      "description": "Localhost: 127.0.0.1 vs 127.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "127.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "127.0.0.0/8",
          "outbound": "localhost"
        }
      ],
      "expected": {
        "outbound": "localhost",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_localhost_002",
      "category": "geoip_cidr_localhost",
      "description": "Localhost: 127.255.255.255 vs 127.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "127.255.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "127.0.0.0/8",
          "outbound": "localhost"
        }
      ],
      "expected": {
        "outbound": "localhost",
        "match_type": "geoip"
      }
    },
    {
      "id": "geoip_cidr_localhost_003",
      "category": "geoip_cidr_localhost",
      "description": "Localhost: 128.0.0.1 vs 127.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "128.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "127.0.0.0/8",
          "outbound": "localhost"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "geoip_cidr_localhost_004",
      "category": "geoip_cidr_localhost",
      "description": "Localhost: ::1 vs ::1/128",
      "input": {
        "domain": null,
        "dest_ip": "::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "::1/128",
          "outbound": "localhost"
        }
      ],
      "expected": {
        "outbound": "localhost",
        "match_type": "geoip"
      }
    },
    {
      "id": "port_single_001",
      "category": "port_single",
      "description": "Single port: 80 vs 80",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 80,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_single_002",
      "category": "port_single",
      "description": "Single port: 443 vs 443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_single_003",
      "category": "port_single",
      "description": "Single port: 8080 vs 8080",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 8080,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8080",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_single_004",
      "category": "port_single",
      "description": "Single port: 22 vs 22",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 22,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "22",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_single_005",
      "category": "port_single",
      "description": "Single port: 81 vs 80",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 81,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_single_006",
      "category": "port_single",
      "description": "Single port: 442 vs 443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 442,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_range_001",
      "category": "port_range",
      "description": "Port range: 80 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 80,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_002",
      "category": "port_range",
      "description": "Port range: 443 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_003",
      "category": "port_range",
      "description": "Port range: 200 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 200,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_004",
      "category": "port_range",
      "description": "Port range: 79 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 79,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_range_005",
      "category": "port_range",
      "description": "Port range: 444 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 444,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_range_006",
      "category": "port_range",
      "description": "Port range: 1 vs 1-1024",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 1,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1-1024",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_007",
      "category": "port_range",
      "description": "Port range: 1024 vs 1-1024",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 1024,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1-1024",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_008",
      "category": "port_range",
      "description": "Port range: 512 vs 1-1024",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 512,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1-1024",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_010",
      "category": "port_range",
      "description": "Port range: 1025 vs 1-1024",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 1025,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1-1024",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_range_011",
      "category": "port_range",
      "description": "Port range: 8000 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 8000,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_012",
      "category": "port_range",
      "description": "Port range: 9000 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 9000,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_013",
      "category": "port_range",
      "description": "Port range: 8500 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 8500,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_range_014",
      "category": "port_range",
      "description": "Port range: 7999 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 7999,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_range_015",
      "category": "port_range",
      "description": "Port range: 9001 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 9001,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "port_edge_001",
      "category": "port_edge",
      "description": "Edge port: 1",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 1,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_edge_002",
      "category": "port_edge",
      "description": "Edge port: 65535",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 65535,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "65535",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_edge_003",
      "category": "port_edge",
      "description": "Edge port: 65534",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 65534,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "65534",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_001",
      "category": "protocol",
      "description": "Protocol: tcp vs rule tcp",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "tcp",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_002",
      "category": "protocol",
      "description": "Protocol: udp vs rule udp",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "udp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "udp",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_003",
      "category": "protocol",
      "description": "Protocol: udp vs rule tcp",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "udp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "tcp",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "protocol_004",
      "category": "protocol",
      "description": "Protocol: tcp vs rule udp",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "udp",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "protocol_005",
      "category": "protocol",
      "description": "Protocol: tcp vs rule TCP",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "TCP",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_006",
      "category": "protocol",
      "description": "Protocol: udp vs rule UDP",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "udp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "UDP",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_sniffed_001",
      "category": "protocol_sniffed",
      "description": "Sniffed protocol: tls vs tls",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp",
        "sniffed_protocol": "tls"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "tls",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_sniffed_002",
      "category": "protocol_sniffed",
      "description": "Sniffed protocol: http vs http",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp",
        "sniffed_protocol": "http"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "http",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_sniffed_003",
      "category": "protocol_sniffed",
      "description": "Sniffed protocol: quic vs quic",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "udp",
        "sniffed_protocol": "quic"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "quic",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "protocol_sniffed_004",
      "category": "protocol_sniffed",
      "description": "Sniffed protocol: http vs tls",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp",
        "sniffed_protocol": "http"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "tls",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "protocol_sniffed_005",
      "category": "protocol_sniffed",
      "description": "Sniffed protocol: tls vs http",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp",
        "sniffed_protocol": "tls"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "http",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "priority_domain_over_geoip_001",
      "category": "priority",
      "description": "Domain rule takes priority over GeoIP",
      "input": {
        "domain": "example.com",
        "dest_ip": "10.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "example.com",
          "outbound": "domain-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        }
      ],
      "expected": {
        "outbound": "domain-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "priority_domain_order_001",
      "category": "priority",
      "description": "First matching domain rule wins",
      "input": {
        "domain": "www.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "first-proxy"
        },
        {
          "type": "domain_keyword",
          "target": "example",
          "outbound": "second-proxy"
        }
      ],
      "expected": {
        "outbound": "first-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "priority_exact_over_suffix_001",
      "category": "priority",
      "description": "Exact domain match over suffix",
      "input": {
        "domain": "example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "example.com",
          "outbound": "exact-proxy"
        },
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "suffix-proxy"
        }
      ],
      "expected": {
        "outbound": "exact-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "priority_geoip_over_port_001",
      "category": "priority",
      "description": "GeoIP takes priority over port rules",
      "input": {
        "domain": null,
        "dest_ip": "10.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "443",
          "outbound": "https-proxy"
        }
      ],
      "expected": {
        "outbound": "private",
        "match_type": "geoip"
      }
    },
    {
      "id": "priority_chain_routing_001",
      "category": "priority_chain",
      "description": "Chain routing with routing mark",
      "input": {
        "domain": "stream.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "us-stream"
        }
      ],
      "chains": [
        "us-stream"
      ],
      "expected": {
        "outbound": "us-stream",
        "match_type": "domain",
        "has_routing_mark": true
      }
    },
    {
      "id": "priority_cidr_specific_001",
      "category": "priority",
      "description": "More specific CIDR should be added first",
      "input": {
        "domain": null,
        "dest_ip": "192.168.1.100",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.1.0/24",
          "outbound": "subnet"
        },
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "network"
        }
      ],
      "expected": {
        "outbound": "subnet",
        "match_type": "geoip"
      }
    },
    {
      "id": "priority_default_001",
      "category": "priority",
      "description": "No match falls to default",
      "input": {
        "domain": "unknown.org",
        "dest_ip": "100.100.100.100",
        "dest_port": 12345,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "443",
          "outbound": "https"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "chain_basic_001",
      "category": "chain_routing",
      "description": "Chain routing: us-stream with DSCP 1",
      "input": {
        "domain": "test-us-stream.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "test-us-stream.example.com",
          "outbound": "us-stream"
        }
      ],
      "chains": [
        {
          "tag": "us-stream",
          "dscp": 1
        }
      ],
      "expected": {
        "outbound": "us-stream",
        "match_type": "domain",
        "has_routing_mark": true,
        "routing_mark": 769
      }
    },
    {
      "id": "chain_basic_002",
      "category": "chain_routing",
      "description": "Chain routing: jp-gaming with DSCP 2",
      "input": {
        "domain": "test-jp-gaming.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "test-jp-gaming.example.com",
          "outbound": "jp-gaming"
        }
      ],
      "chains": [
        {
          "tag": "jp-gaming",
          "dscp": 2
        }
      ],
      "expected": {
        "outbound": "jp-gaming",
        "match_type": "domain",
        "has_routing_mark": true,
        "routing_mark": 770
      }
    },
    {
      "id": "chain_basic_003",
      "category": "chain_routing",
      "description": "Chain routing: eu-work with DSCP 3",
      "input": {
        "domain": "test-eu-work.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "test-eu-work.example.com",
          "outbound": "eu-work"
        }
      ],
      "chains": [
        {
          "tag": "eu-work",
          "dscp": 3
        }
      ],
      "expected": {
        "outbound": "eu-work",
        "match_type": "domain",
        "has_routing_mark": true,
        "routing_mark": 771
      }
    },
    {
      "id": "chain_basic_004",
      "category": "chain_routing",
      "description": "Chain routing: asia-proxy with DSCP 4",
      "input": {
        "domain": "test-asia-proxy.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "test-asia-proxy.example.com",
          "outbound": "asia-proxy"
        }
      ],
      "chains": [
        {
          "tag": "asia-proxy",
          "dscp": 4
        }
      ],
      "expected": {
        "outbound": "asia-proxy",
        "match_type": "domain",
        "has_routing_mark": true,
        "routing_mark": 772
      }
    },
    {
      "id": "chain_auto_dscp_001",
      "category": "chain_routing",
      "description": "Chain with auto-assigned DSCP",
      "input": {
        "domain": "auto-chain.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "auto-chain.example.com",
          "outbound": "auto-chain"
        }
      ],
      "chains": [
        "auto-chain"
      ],
      "expected": {
        "outbound": "auto-chain",
        "match_type": "domain",
        "has_routing_mark": true
      }
    },
    {
      "id": "chain_non_chain_001",
      "category": "chain_routing",
      "description": "Non-chain outbound has no routing mark",
      "input": {
        "domain": "direct.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "direct.example.com",
          "outbound": "direct"
        }
      ],
      "chains": [
        "other-chain"
      ],
      "expected": {
        "outbound": "direct",
        "match_type": "domain",
        "has_routing_mark": false
      }
    },
    {
      "id": "edge_empty_domain_001",
      "category": "edge_case",
      "description": "Empty domain string",
      "input": {
        "domain": "",
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "edge_no_domain_001",
      "category": "edge_case",
      "description": "No domain, IP only",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "edge_long_domain_001",
      "category": "edge_case",
      "description": "Very long domain name",
      "input": {
        "domain": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "edge_hyphen_domain_001",
      "category": "edge_case",
      "description": "Domain with hyphens",
      "input": {
        "domain": "my-test-domain.example-site.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example-site.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "edge_numeric_domain_001",
      "category": "edge_case",
      "description": "Numeric-looking domain",
      "input": {
        "domain": "123.456.789.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "edge_trailing_dot_001",
      "category": "edge_case",
      "description": "Domain with trailing dot (FQDN)",
      "input": {
        "domain": "www.example.com.",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "edge_no_rules_001",
      "category": "edge_case",
      "description": "No rules, default fallback",
      "input": {
        "domain": "any.domain.com",
        "dest_ip": "1.2.3.4",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "edge_mixed_case_suffix_001",
      "category": "edge_case",
      "description": "Mixed case domain with suffix match",
      "input": {
        "domain": "WWW.EXAMPLE.COM",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "edge_zero_ip_001",
      "category": "edge_case",
      "description": "All zeros IP address",
      "input": {
        "domain": null,
        "dest_ip": "0.0.0.0",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "0.0.0.0/8",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "geoip"
      }
    },
    {
      "id": "edge_broadcast_001",
      "category": "edge_case",
      "description": "Broadcast IP address",
      "input": {
        "domain": null,
        "dest_ip": "255.255.255.255",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "255.255.255.255/32",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "geoip"
      }
    },
    {
      "id": "real_streaming_001",
      "category": "real_world",
      "description": "Streaming service: netflix",
      "input": {
        "domain": "www.netflix.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "netflix.com",
          "outbound": "netflix-proxy"
        }
      ],
      "expected": {
        "outbound": "netflix-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_002",
      "category": "real_world",
      "description": "Streaming service: hulu",
      "input": {
        "domain": "www.hulu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "hulu.com",
          "outbound": "hulu-proxy"
        }
      ],
      "expected": {
        "outbound": "hulu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_003",
      "category": "real_world",
      "description": "Streaming service: disney",
      "input": {
        "domain": "www.disneyplus.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "disneyplus.com",
          "outbound": "disney-proxy"
        }
      ],
      "expected": {
        "outbound": "disney-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_004",
      "category": "real_world",
      "description": "Streaming service: hbo",
      "input": {
        "domain": "www.hbomax.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "hbomax.com",
          "outbound": "hbo-proxy"
        }
      ],
      "expected": {
        "outbound": "hbo-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_005",
      "category": "real_world",
      "description": "Streaming service: amazon",
      "input": {
        "domain": "www.primevideo.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "primevideo.com",
          "outbound": "amazon-proxy"
        }
      ],
      "expected": {
        "outbound": "amazon-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_006",
      "category": "real_world",
      "description": "Streaming service: google",
      "input": {
        "domain": "www.youtube.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "youtube.com",
          "outbound": "google-proxy"
        }
      ],
      "expected": {
        "outbound": "google-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_007",
      "category": "real_world",
      "description": "Streaming service: twitch",
      "input": {
        "domain": "www.twitch.tv",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "twitch.tv",
          "outbound": "twitch-proxy"
        }
      ],
      "expected": {
        "outbound": "twitch-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_008",
      "category": "real_world",
      "description": "Streaming service: crunchyroll",
      "input": {
        "domain": "www.crunchyroll.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "crunchyroll.com",
          "outbound": "crunchyroll-proxy"
        }
      ],
      "expected": {
        "outbound": "crunchyroll-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_009",
      "category": "real_world",
      "description": "Streaming service: peacock",
      "input": {
        "domain": "www.peacocktv.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "peacocktv.com",
          "outbound": "peacock-proxy"
        }
      ],
      "expected": {
        "outbound": "peacock-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_streaming_010",
      "category": "real_world",
      "description": "Streaming service: paramount",
      "input": {
        "domain": "www.paramountplus.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "paramountplus.com",
          "outbound": "paramount-proxy"
        }
      ],
      "expected": {
        "outbound": "paramount-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_001",
      "category": "real_world",
      "description": "Social media: meta",
      "input": {
        "domain": "facebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "facebook.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_002",
      "category": "real_world",
      "description": "Social media: meta",
      "input": {
        "domain": "instagram.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "instagram.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_003",
      "category": "real_world",
      "description": "Social media: twitter",
      "input": {
        "domain": "twitter.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "twitter.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_004",
      "category": "real_world",
      "description": "Social media: twitter",
      "input": {
        "domain": "x.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "x.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_005",
      "category": "real_world",
      "description": "Social media: tiktok",
      "input": {
        "domain": "tiktok.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "tiktok.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_006",
      "category": "real_world",
      "description": "Social media: linkedin",
      "input": {
        "domain": "linkedin.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "linkedin.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_007",
      "category": "real_world",
      "description": "Social media: pinterest",
      "input": {
        "domain": "pinterest.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "pinterest.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_008",
      "category": "real_world",
      "description": "Social media: reddit",
      "input": {
        "domain": "reddit.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "reddit.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_009",
      "category": "real_world",
      "description": "Social media: snapchat",
      "input": {
        "domain": "snapchat.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "snapchat.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_010",
      "category": "real_world",
      "description": "Social media: discord",
      "input": {
        "domain": "discord.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "discord.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_011",
      "category": "real_world",
      "description": "Social media: slack",
      "input": {
        "domain": "slack.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "slack.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_012",
      "category": "real_world",
      "description": "Social media: telegram",
      "input": {
        "domain": "telegram.org",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "telegram.org",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_social_013",
      "category": "real_world",
      "description": "Social media: whatsapp",
      "input": {
        "domain": "whatsapp.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "whatsapp.com",
          "outbound": "social-proxy"
        }
      ],
      "expected": {
        "outbound": "social-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_001",
      "category": "real_world",
      "description": "Developer tool: github.com",
      "input": {
        "domain": "github.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "github.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_002",
      "category": "real_world",
      "description": "Developer tool: gitlab.com",
      "input": {
        "domain": "gitlab.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "gitlab.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_003",
      "category": "real_world",
      "description": "Developer tool: bitbucket.org",
      "input": {
        "domain": "bitbucket.org",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "bitbucket.org",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_004",
      "category": "real_world",
      "description": "Developer tool: stackoverflow.com",
      "input": {
        "domain": "stackoverflow.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "stackoverflow.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_005",
      "category": "real_world",
      "description": "Developer tool: npmjs.com",
      "input": {
        "domain": "npmjs.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "npmjs.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_006",
      "category": "real_world",
      "description": "Developer tool: pypi.org",
      "input": {
        "domain": "pypi.org",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "pypi.org",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_007",
      "category": "real_world",
      "description": "Developer tool: crates.io",
      "input": {
        "domain": "crates.io",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "crates.io",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_008",
      "category": "real_world",
      "description": "Developer tool: docker.com",
      "input": {
        "domain": "docker.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "docker.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_009",
      "category": "real_world",
      "description": "Developer tool: kubernetes.io",
      "input": {
        "domain": "kubernetes.io",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "kubernetes.io",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_010",
      "category": "real_world",
      "description": "Developer tool: terraform.io",
      "input": {
        "domain": "terraform.io",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "terraform.io",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_011",
      "category": "real_world",
      "description": "Developer tool: ansible.com",
      "input": {
        "domain": "ansible.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ansible.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_012",
      "category": "real_world",
      "description": "Developer tool: jenkins.io",
      "input": {
        "domain": "jenkins.io",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "jenkins.io",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_013",
      "category": "real_world",
      "description": "Developer tool: circleci.com",
      "input": {
        "domain": "circleci.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "circleci.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_014",
      "category": "real_world",
      "description": "Developer tool: travis-ci.com",
      "input": {
        "domain": "travis-ci.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "travis-ci.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_015",
      "category": "real_world",
      "description": "Developer tool: vercel.com",
      "input": {
        "domain": "vercel.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "vercel.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_016",
      "category": "real_world",
      "description": "Developer tool: netlify.com",
      "input": {
        "domain": "netlify.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "netlify.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_017",
      "category": "real_world",
      "description": "Developer tool: heroku.com",
      "input": {
        "domain": "heroku.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "heroku.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_018",
      "category": "real_world",
      "description": "Developer tool: aws.amazon.com",
      "input": {
        "domain": "aws.amazon.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "aws.amazon.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_019",
      "category": "real_world",
      "description": "Developer tool: cloud.google.com",
      "input": {
        "domain": "cloud.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cloud.google.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_dev_020",
      "category": "real_world",
      "description": "Developer tool: azure.microsoft.com",
      "input": {
        "domain": "azure.microsoft.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "azure.microsoft.com",
          "outbound": "dev-proxy"
        }
      ],
      "expected": {
        "outbound": "dev-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_001",
      "category": "real_world",
      "description": "Ad blocking keyword: ads",
      "input": {
        "domain": "ads.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "ads",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_002",
      "category": "real_world",
      "description": "Ad blocking keyword: tracking",
      "input": {
        "domain": "tracking.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "tracking",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_003",
      "category": "real_world",
      "description": "Ad blocking keyword: analytics",
      "input": {
        "domain": "analytics.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "analytics",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_004",
      "category": "real_world",
      "description": "Ad blocking keyword: telemetry",
      "input": {
        "domain": "telemetry.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "telemetry",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_005",
      "category": "real_world",
      "description": "Ad blocking keyword: metrics",
      "input": {
        "domain": "metrics.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "metrics",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_006",
      "category": "real_world",
      "description": "Ad blocking keyword: beacon",
      "input": {
        "domain": "beacon.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "beacon",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_007",
      "category": "real_world",
      "description": "Ad blocking keyword: pixel",
      "input": {
        "domain": "pixel.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "pixel",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_008",
      "category": "real_world",
      "description": "Ad blocking keyword: tracker",
      "input": {
        "domain": "tracker.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "tracker",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_009",
      "category": "real_world",
      "description": "Ad blocking keyword: adserver",
      "input": {
        "domain": "adserver.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "adserver",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "real_adblock_010",
      "category": "real_world",
      "description": "Ad blocking keyword: doubleclick",
      "input": {
        "domain": "doubleclick.example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "doubleclick",
          "outbound": "block"
        }
      ],
      "expected": {
        "outbound": "block",
        "match_type": "domain"
      }
    },
    {
      "id": "cidr_cloud_001",
      "category": "cidr_cloud",
      "description": "Cloud provider aws: 13.52.100.50",
      "input": {
        "domain": null,
        "dest_ip": "13.52.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "13.0.0.0/8",
          "outbound": "aws-proxy"
        }
      ],
      "expected": {
        "outbound": "aws-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_002",
      "category": "cidr_cloud",
      "description": "Cloud provider gcp: 34.102.50.25",
      "input": {
        "domain": null,
        "dest_ip": "34.102.50.25",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "34.0.0.0/8",
          "outbound": "gcp-proxy"
        }
      ],
      "expected": {
        "outbound": "gcp-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_003",
      "category": "cidr_cloud",
      "description": "Cloud provider azure: 40.112.100.50",
      "input": {
        "domain": null,
        "dest_ip": "40.112.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "40.0.0.0/8",
          "outbound": "azure-proxy"
        }
      ],
      "expected": {
        "outbound": "azure-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_004",
      "category": "cidr_cloud",
      "description": "Cloud provider aws: 52.95.100.50",
      "input": {
        "domain": null,
        "dest_ip": "52.95.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "52.0.0.0/8",
          "outbound": "aws-proxy"
        }
      ],
      "expected": {
        "outbound": "aws-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_005",
      "category": "cidr_cloud",
      "description": "Cloud provider aws: 54.200.100.50",
      "input": {
        "domain": null,
        "dest_ip": "54.200.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "54.0.0.0/8",
          "outbound": "aws-proxy"
        }
      ],
      "expected": {
        "outbound": "aws-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_006",
      "category": "cidr_cloud",
      "description": "Cloud provider cloudflare: 104.16.50.25",
      "input": {
        "domain": null,
        "dest_ip": "104.16.50.25",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "104.0.0.0/8",
          "outbound": "cloudflare-proxy"
        }
      ],
      "expected": {
        "outbound": "cloudflare-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_007",
      "category": "cidr_cloud",
      "description": "Cloud provider google: 142.250.100.50",
      "input": {
        "domain": null,
        "dest_ip": "142.250.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "142.250.0.0/16",
          "outbound": "google-proxy"
        }
      ],
      "expected": {
        "outbound": "google-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_008",
      "category": "cidr_cloud",
      "description": "Cloud provider fastly: 151.101.100.50",
      "input": {
        "domain": null,
        "dest_ip": "151.101.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "151.101.0.0/16",
          "outbound": "fastly-proxy"
        }
      ],
      "expected": {
        "outbound": "fastly-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_009",
      "category": "cidr_cloud",
      "description": "Cloud provider facebook: 157.240.100.50",
      "input": {
        "domain": null,
        "dest_ip": "157.240.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "157.240.0.0/16",
          "outbound": "facebook-proxy"
        }
      ],
      "expected": {
        "outbound": "facebook-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_cloud_010",
      "category": "cidr_cloud",
      "description": "Cloud provider google: 172.217.100.50",
      "input": {
        "domain": null,
        "dest_ip": "172.217.100.50",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.217.0.0/16",
          "outbound": "google-proxy"
        }
      ],
      "expected": {
        "outbound": "google-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_001",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region north-america: 2600::1",
      "input": {
        "domain": null,
        "dest_ip": "2600::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2600::/12",
          "outbound": "north-america-proxy"
        }
      ],
      "expected": {
        "outbound": "north-america-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_002",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region asia-pacific: 2400::1",
      "input": {
        "domain": null,
        "dest_ip": "2400::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2400::/12",
          "outbound": "asia-pacific-proxy"
        }
      ],
      "expected": {
        "outbound": "asia-pacific-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_003",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region latin-america: 2800::1",
      "input": {
        "domain": null,
        "dest_ip": "2800::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2800::/12",
          "outbound": "latin-america-proxy"
        }
      ],
      "expected": {
        "outbound": "latin-america-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_004",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region europe: 2a00::1",
      "input": {
        "domain": null,
        "dest_ip": "2a00::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2a00::/12",
          "outbound": "europe-proxy"
        }
      ],
      "expected": {
        "outbound": "europe-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_005",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region africa: 2c00::1",
      "input": {
        "domain": null,
        "dest_ip": "2c00::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2c00::/12",
          "outbound": "africa-proxy"
        }
      ],
      "expected": {
        "outbound": "africa-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_006",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region google-ipv6: 2001:4860::1",
      "input": {
        "domain": null,
        "dest_ip": "2001:4860::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2001:4860::/32",
          "outbound": "google-ipv6-proxy"
        }
      ],
      "expected": {
        "outbound": "google-ipv6-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_007",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region cloudflare-ipv6: 2606:4700::1",
      "input": {
        "domain": null,
        "dest_ip": "2606:4700::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2606:4700::/32",
          "outbound": "cloudflare-ipv6-proxy"
        }
      ],
      "expected": {
        "outbound": "cloudflare-ipv6-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_ipv6_region_008",
      "category": "cidr_ipv6_region",
      "description": "IPv6 region facebook-ipv6: 2620:1ec::1",
      "input": {
        "domain": null,
        "dest_ip": "2620:1ec::1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "2620:1ec::/48",
          "outbound": "facebook-ipv6-proxy"
        }
      ],
      "expected": {
        "outbound": "facebook-ipv6-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_08",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /8",
      "input": {
        "domain": null,
        "dest_ip": "203.8.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.8.0.0/8",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_12",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /12",
      "input": {
        "domain": null,
        "dest_ip": "203.12.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.12.0.0/12",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_16",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /16",
      "input": {
        "domain": null,
        "dest_ip": "203.16.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.16.0.0/16",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_20",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /20",
      "input": {
        "domain": null,
        "dest_ip": "203.20.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.20.0.0/20",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_24",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /24",
      "input": {
        "domain": null,
        "dest_ip": "203.24.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.24.0.0/24",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_28",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /28",
      "input": {
        "domain": null,
        "dest_ip": "203.28.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.28.0.0/28",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_30",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /30",
      "input": {
        "domain": null,
        "dest_ip": "203.30.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.30.0.0/30",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "cidr_prefix_32",
      "category": "cidr_prefix_variety",
      "description": "CIDR prefix /32",
      "input": {
        "domain": null,
        "dest_ip": "203.32.0.0",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "203.32.0.0/32",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "domain_top_001",
      "category": "domain_top_sites",
      "description": "Top website: google.com",
      "input": {
        "domain": "google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_002",
      "category": "domain_top_sites",
      "description": "Top website: youtube.com",
      "input": {
        "domain": "youtube.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "youtube.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_003",
      "category": "domain_top_sites",
      "description": "Top website: facebook.com",
      "input": {
        "domain": "facebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "facebook.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_004",
      "category": "domain_top_sites",
      "description": "Top website: baidu.com",
      "input": {
        "domain": "baidu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "baidu.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_005",
      "category": "domain_top_sites",
      "description": "Top website: wikipedia.org",
      "input": {
        "domain": "wikipedia.org",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "wikipedia.org",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_006",
      "category": "domain_top_sites",
      "description": "Top website: qq.com",
      "input": {
        "domain": "qq.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "qq.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_007",
      "category": "domain_top_sites",
      "description": "Top website: yahoo.com",
      "input": {
        "domain": "yahoo.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "yahoo.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_008",
      "category": "domain_top_sites",
      "description": "Top website: amazon.com",
      "input": {
        "domain": "amazon.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "amazon.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_009",
      "category": "domain_top_sites",
      "description": "Top website: twitter.com",
      "input": {
        "domain": "twitter.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "twitter.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_010",
      "category": "domain_top_sites",
      "description": "Top website: instagram.com",
      "input": {
        "domain": "instagram.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "instagram.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_011",
      "category": "domain_top_sites",
      "description": "Top website: linkedin.com",
      "input": {
        "domain": "linkedin.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "linkedin.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_012",
      "category": "domain_top_sites",
      "description": "Top website: reddit.com",
      "input": {
        "domain": "reddit.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "reddit.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_013",
      "category": "domain_top_sites",
      "description": "Top website: netflix.com",
      "input": {
        "domain": "netflix.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "netflix.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_014",
      "category": "domain_top_sites",
      "description": "Top website: microsoft.com",
      "input": {
        "domain": "microsoft.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "microsoft.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_015",
      "category": "domain_top_sites",
      "description": "Top website: apple.com",
      "input": {
        "domain": "apple.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "apple.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_016",
      "category": "domain_top_sites",
      "description": "Top website: bing.com",
      "input": {
        "domain": "bing.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "bing.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_017",
      "category": "domain_top_sites",
      "description": "Top website: office.com",
      "input": {
        "domain": "office.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "office.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_018",
      "category": "domain_top_sites",
      "description": "Top website: zoom.us",
      "input": {
        "domain": "zoom.us",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "zoom.us",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_019",
      "category": "domain_top_sites",
      "description": "Top website: tiktok.com",
      "input": {
        "domain": "tiktok.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "tiktok.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_020",
      "category": "domain_top_sites",
      "description": "Top website: pinterest.com",
      "input": {
        "domain": "pinterest.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "pinterest.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_021",
      "category": "domain_top_sites",
      "description": "Top website: ebay.com",
      "input": {
        "domain": "ebay.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "ebay.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_022",
      "category": "domain_top_sites",
      "description": "Top website: aliexpress.com",
      "input": {
        "domain": "aliexpress.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "aliexpress.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_023",
      "category": "domain_top_sites",
      "description": "Top website: taobao.com",
      "input": {
        "domain": "taobao.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "taobao.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_024",
      "category": "domain_top_sites",
      "description": "Top website: jd.com",
      "input": {
        "domain": "jd.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "jd.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_025",
      "category": "domain_top_sites",
      "description": "Top website: weibo.com",
      "input": {
        "domain": "weibo.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "weibo.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_026",
      "category": "domain_top_sites",
      "description": "Top website: sina.com.cn",
      "input": {
        "domain": "sina.com.cn",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "sina.com.cn",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_027",
      "category": "domain_top_sites",
      "description": "Top website: 163.com",
      "input": {
        "domain": "163.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "163.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_028",
      "category": "domain_top_sites",
      "description": "Top website: sohu.com",
      "input": {
        "domain": "sohu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "sohu.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_029",
      "category": "domain_top_sites",
      "description": "Top website: zhihu.com",
      "input": {
        "domain": "zhihu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "zhihu.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_030",
      "category": "domain_top_sites",
      "description": "Top website: bilibili.com",
      "input": {
        "domain": "bilibili.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "bilibili.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_031",
      "category": "domain_top_sites",
      "description": "Top website: medium.com",
      "input": {
        "domain": "medium.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "medium.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_032",
      "category": "domain_top_sites",
      "description": "Top website: quora.com",
      "input": {
        "domain": "quora.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "quora.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_033",
      "category": "domain_top_sites",
      "description": "Top website: tumblr.com",
      "input": {
        "domain": "tumblr.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "tumblr.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_034",
      "category": "domain_top_sites",
      "description": "Top website: wordpress.com",
      "input": {
        "domain": "wordpress.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "wordpress.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_035",
      "category": "domain_top_sites",
      "description": "Top website: blogger.com",
      "input": {
        "domain": "blogger.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "blogger.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_036",
      "category": "domain_top_sites",
      "description": "Top website: dropbox.com",
      "input": {
        "domain": "dropbox.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "dropbox.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_037",
      "category": "domain_top_sites",
      "description": "Top website: icloud.com",
      "input": {
        "domain": "icloud.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "icloud.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_038",
      "category": "domain_top_sites",
      "description": "Top website: onedrive.com",
      "input": {
        "domain": "onedrive.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "onedrive.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_039",
      "category": "domain_top_sites",
      "description": "Top website: drive.google.com",
      "input": {
        "domain": "drive.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "drive.google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_040",
      "category": "domain_top_sites",
      "description": "Top website: box.com",
      "input": {
        "domain": "box.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "box.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_041",
      "category": "domain_top_sites",
      "description": "Top website: zoom.us",
      "input": {
        "domain": "zoom.us",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "zoom.us",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_042",
      "category": "domain_top_sites",
      "description": "Top website: teams.microsoft.com",
      "input": {
        "domain": "teams.microsoft.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "teams.microsoft.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_043",
      "category": "domain_top_sites",
      "description": "Top website: meet.google.com",
      "input": {
        "domain": "meet.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "meet.google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_044",
      "category": "domain_top_sites",
      "description": "Top website: webex.com",
      "input": {
        "domain": "webex.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "webex.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_045",
      "category": "domain_top_sites",
      "description": "Top website: gotomeeting.com",
      "input": {
        "domain": "gotomeeting.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "gotomeeting.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_046",
      "category": "domain_top_sites",
      "description": "Top website: paypal.com",
      "input": {
        "domain": "paypal.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "paypal.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_047",
      "category": "domain_top_sites",
      "description": "Top website: stripe.com",
      "input": {
        "domain": "stripe.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "stripe.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_048",
      "category": "domain_top_sites",
      "description": "Top website: square.com",
      "input": {
        "domain": "square.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "square.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_049",
      "category": "domain_top_sites",
      "description": "Top website: venmo.com",
      "input": {
        "domain": "venmo.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "venmo.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_top_050",
      "category": "domain_top_sites",
      "description": "Top website: cash.app",
      "input": {
        "domain": "cash.app",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain",
          "target": "cash.app",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_001",
      "category": "domain_subdomains",
      "description": "Subdomain: www.google.com",
      "input": {
        "domain": "www.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_002",
      "category": "domain_subdomains",
      "description": "Subdomain: mail.google.com",
      "input": {
        "domain": "mail.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_003",
      "category": "domain_subdomains",
      "description": "Subdomain: drive.google.com",
      "input": {
        "domain": "drive.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_004",
      "category": "domain_subdomains",
      "description": "Subdomain: docs.google.com",
      "input": {
        "domain": "docs.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_005",
      "category": "domain_subdomains",
      "description": "Subdomain: calendar.google.com",
      "input": {
        "domain": "calendar.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_006",
      "category": "domain_subdomains",
      "description": "Subdomain: api.github.com",
      "input": {
        "domain": "api.github.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "github.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_007",
      "category": "domain_subdomains",
      "description": "Subdomain: raw.githubusercontent.com",
      "input": {
        "domain": "raw.githubusercontent.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "githubusercontent.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_008",
      "category": "domain_subdomains",
      "description": "Subdomain: gist.github.com",
      "input": {
        "domain": "gist.github.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "github.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_009",
      "category": "domain_subdomains",
      "description": "Subdomain: cdn.jsdelivr.net",
      "input": {
        "domain": "cdn.jsdelivr.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "jsdelivr.net",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_010",
      "category": "domain_subdomains",
      "description": "Subdomain: unpkg.com",
      "input": {
        "domain": "unpkg.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_011",
      "category": "domain_subdomains",
      "description": "Subdomain: m.facebook.com",
      "input": {
        "domain": "m.facebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "facebook.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_012",
      "category": "domain_subdomains",
      "description": "Subdomain: mobile.twitter.com",
      "input": {
        "domain": "mobile.twitter.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "twitter.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_013",
      "category": "domain_subdomains",
      "description": "Subdomain: i.imgur.com",
      "input": {
        "domain": "i.imgur.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "imgur.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_014",
      "category": "domain_subdomains",
      "description": "Subdomain: static.reddit.com",
      "input": {
        "domain": "static.reddit.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "reddit.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_subdomain_015",
      "category": "domain_subdomains",
      "description": "Subdomain: v.redd.it",
      "input": {
        "domain": "v.redd.it",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "redd.it",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_001",
      "category": "domain_tlds",
      "description": "TLD variation: .com",
      "input": {
        "domain": "example.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_002",
      "category": "domain_tlds",
      "description": "TLD variation: .org",
      "input": {
        "domain": "example.org",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".org",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_003",
      "category": "domain_tlds",
      "description": "TLD variation: .net",
      "input": {
        "domain": "example.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".net",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_004",
      "category": "domain_tlds",
      "description": "TLD variation: .io",
      "input": {
        "domain": "example.io",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".io",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_005",
      "category": "domain_tlds",
      "description": "TLD variation: .co",
      "input": {
        "domain": "example.co",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".co",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_006",
      "category": "domain_tlds",
      "description": "TLD variation: .app",
      "input": {
        "domain": "example.app",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".app",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_007",
      "category": "domain_tlds",
      "description": "TLD variation: .dev",
      "input": {
        "domain": "example.dev",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".dev",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_008",
      "category": "domain_tlds",
      "description": "TLD variation: .cloud",
      "input": {
        "domain": "example.cloud",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".cloud",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_009",
      "category": "domain_tlds",
      "description": "TLD variation: .ai",
      "input": {
        "domain": "example.ai",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".ai",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_010",
      "category": "domain_tlds",
      "description": "TLD variation: .xyz",
      "input": {
        "domain": "example.xyz",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".xyz",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_011",
      "category": "domain_tlds",
      "description": "TLD variation: .tech",
      "input": {
        "domain": "example.tech",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".tech",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_tld_012",
      "category": "domain_tlds",
      "description": "TLD variation: .info",
      "input": {
        "domain": "example.info",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".info",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_001",
      "category": "domain_cctlds",
      "description": "Country code TLD: .cn",
      "input": {
        "domain": "example.cn",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".cn",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_002",
      "category": "domain_cctlds",
      "description": "Country code TLD: .ru",
      "input": {
        "domain": "example.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_003",
      "category": "domain_cctlds",
      "description": "Country code TLD: .jp",
      "input": {
        "domain": "example.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_004",
      "category": "domain_cctlds",
      "description": "Country code TLD: .kr",
      "input": {
        "domain": "example.kr",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".kr",
          "outbound": "kr-proxy"
        }
      ],
      "expected": {
        "outbound": "kr-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_005",
      "category": "domain_cctlds",
      "description": "Country code TLD: .de",
      "input": {
        "domain": "example.de",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".de",
          "outbound": "de-proxy"
        }
      ],
      "expected": {
        "outbound": "de-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_006",
      "category": "domain_cctlds",
      "description": "Country code TLD: .fr",
      "input": {
        "domain": "example.fr",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".fr",
          "outbound": "fr-proxy"
        }
      ],
      "expected": {
        "outbound": "fr-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_007",
      "category": "domain_cctlds",
      "description": "Country code TLD: .uk",
      "input": {
        "domain": "example.uk",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".uk",
          "outbound": "uk-proxy"
        }
      ],
      "expected": {
        "outbound": "uk-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_008",
      "category": "domain_cctlds",
      "description": "Country code TLD: .au",
      "input": {
        "domain": "example.au",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".au",
          "outbound": "au-proxy"
        }
      ],
      "expected": {
        "outbound": "au-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_009",
      "category": "domain_cctlds",
      "description": "Country code TLD: .br",
      "input": {
        "domain": "example.br",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".br",
          "outbound": "br-proxy"
        }
      ],
      "expected": {
        "outbound": "br-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_010",
      "category": "domain_cctlds",
      "description": "Country code TLD: .in",
      "input": {
        "domain": "example.in",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".in",
          "outbound": "in-proxy"
        }
      ],
      "expected": {
        "outbound": "in-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_011",
      "category": "domain_cctlds",
      "description": "Country code TLD: .mx",
      "input": {
        "domain": "example.mx",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".mx",
          "outbound": "mx-proxy"
        }
      ],
      "expected": {
        "outbound": "mx-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_012",
      "category": "domain_cctlds",
      "description": "Country code TLD: .es",
      "input": {
        "domain": "example.es",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".es",
          "outbound": "es-proxy"
        }
      ],
      "expected": {
        "outbound": "es-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_013",
      "category": "domain_cctlds",
      "description": "Country code TLD: .it",
      "input": {
        "domain": "example.it",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".it",
          "outbound": "it-proxy"
        }
      ],
      "expected": {
        "outbound": "it-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_014",
      "category": "domain_cctlds",
      "description": "Country code TLD: .nl",
      "input": {
        "domain": "example.nl",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".nl",
          "outbound": "nl-proxy"
        }
      ],
      "expected": {
        "outbound": "nl-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "domain_cctld_015",
      "category": "domain_cctlds",
      "description": "Country code TLD: .se",
      "input": {
        "domain": "example.se",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": ".se",
          "outbound": "se-proxy"
        }
      ],
      "expected": {
        "outbound": "se-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "port_service_001",
      "category": "port_services",
      "description": "Service port: ftp (21)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 21,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "21",
          "outbound": "ftp-proxy"
        }
      ],
      "expected": {
        "outbound": "ftp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_002",
      "category": "port_services",
      "description": "Service port: ssh (22)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 22,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "22",
          "outbound": "ssh-proxy"
        }
      ],
      "expected": {
        "outbound": "ssh-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_003",
      "category": "port_services",
      "description": "Service port: telnet (23)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 23,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "23",
          "outbound": "telnet-proxy"
        }
      ],
      "expected": {
        "outbound": "telnet-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_004",
      "category": "port_services",
      "description": "Service port: smtp (25)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 25,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "25",
          "outbound": "smtp-proxy"
        }
      ],
      "expected": {
        "outbound": "smtp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_005",
      "category": "port_services",
      "description": "Service port: dns (53)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 53,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "53",
          "outbound": "dns-proxy"
        }
      ],
      "expected": {
        "outbound": "dns-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_006",
      "category": "port_services",
      "description": "Service port: dhcp (67)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 67,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "67",
          "outbound": "dhcp-proxy"
        }
      ],
      "expected": {
        "outbound": "dhcp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_007",
      "category": "port_services",
      "description": "Service port: dhcp-client (68)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 68,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "68",
          "outbound": "dhcp-client-proxy"
        }
      ],
      "expected": {
        "outbound": "dhcp-client-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_008",
      "category": "port_services",
      "description": "Service port: tftp (69)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 69,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "69",
          "outbound": "tftp-proxy"
        }
      ],
      "expected": {
        "outbound": "tftp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_009",
      "category": "port_services",
      "description": "Service port: http (80)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 80,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80",
          "outbound": "http-proxy"
        }
      ],
      "expected": {
        "outbound": "http-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_010",
      "category": "port_services",
      "description": "Service port: pop3 (110)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 110,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "110",
          "outbound": "pop3-proxy"
        }
      ],
      "expected": {
        "outbound": "pop3-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_011",
      "category": "port_services",
      "description": "Service port: nntp (119)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 119,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "119",
          "outbound": "nntp-proxy"
        }
      ],
      "expected": {
        "outbound": "nntp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_012",
      "category": "port_services",
      "description": "Service port: ntp (123)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 123,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "123",
          "outbound": "ntp-proxy"
        }
      ],
      "expected": {
        "outbound": "ntp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_013",
      "category": "port_services",
      "description": "Service port: imap (143)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 143,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "143",
          "outbound": "imap-proxy"
        }
      ],
      "expected": {
        "outbound": "imap-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_014",
      "category": "port_services",
      "description": "Service port: snmp (161)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 161,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "161",
          "outbound": "snmp-proxy"
        }
      ],
      "expected": {
        "outbound": "snmp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_015",
      "category": "port_services",
      "description": "Service port: snmp-trap (162)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 162,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "162",
          "outbound": "snmp-trap-proxy"
        }
      ],
      "expected": {
        "outbound": "snmp-trap-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_016",
      "category": "port_services",
      "description": "Service port: ldap (389)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 389,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "389",
          "outbound": "ldap-proxy"
        }
      ],
      "expected": {
        "outbound": "ldap-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_017",
      "category": "port_services",
      "description": "Service port: https (443)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "443",
          "outbound": "https-proxy"
        }
      ],
      "expected": {
        "outbound": "https-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_018",
      "category": "port_services",
      "description": "Service port: smb (445)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 445,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "445",
          "outbound": "smb-proxy"
        }
      ],
      "expected": {
        "outbound": "smb-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_019",
      "category": "port_services",
      "description": "Service port: smtps (465)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 465,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "465",
          "outbound": "smtps-proxy"
        }
      ],
      "expected": {
        "outbound": "smtps-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_020",
      "category": "port_services",
      "description": "Service port: syslog (514)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 514,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "514",
          "outbound": "syslog-proxy"
        }
      ],
      "expected": {
        "outbound": "syslog-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_021",
      "category": "port_services",
      "description": "Service port: submission (587)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 587,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "587",
          "outbound": "submission-proxy"
        }
      ],
      "expected": {
        "outbound": "submission-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_022",
      "category": "port_services",
      "description": "Service port: ldaps (636)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 636,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "636",
          "outbound": "ldaps-proxy"
        }
      ],
      "expected": {
        "outbound": "ldaps-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_023",
      "category": "port_services",
      "description": "Service port: imaps (993)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 993,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "993",
          "outbound": "imaps-proxy"
        }
      ],
      "expected": {
        "outbound": "imaps-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_024",
      "category": "port_services",
      "description": "Service port: pop3s (995)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 995,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "995",
          "outbound": "pop3s-proxy"
        }
      ],
      "expected": {
        "outbound": "pop3s-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_025",
      "category": "port_services",
      "description": "Service port: mssql (1433)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 1433,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1433",
          "outbound": "mssql-proxy"
        }
      ],
      "expected": {
        "outbound": "mssql-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_026",
      "category": "port_services",
      "description": "Service port: oracle (1521)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 1521,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1521",
          "outbound": "oracle-proxy"
        }
      ],
      "expected": {
        "outbound": "oracle-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_027",
      "category": "port_services",
      "description": "Service port: mysql (3306)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 3306,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "3306",
          "outbound": "mysql-proxy"
        }
      ],
      "expected": {
        "outbound": "mysql-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_028",
      "category": "port_services",
      "description": "Service port: rdp (3389)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 3389,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "3389",
          "outbound": "rdp-proxy"
        }
      ],
      "expected": {
        "outbound": "rdp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_029",
      "category": "port_services",
      "description": "Service port: postgresql (5432)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 5432,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "5432",
          "outbound": "postgresql-proxy"
        }
      ],
      "expected": {
        "outbound": "postgresql-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_030",
      "category": "port_services",
      "description": "Service port: amqp (5672)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 5672,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "5672",
          "outbound": "amqp-proxy"
        }
      ],
      "expected": {
        "outbound": "amqp-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_031",
      "category": "port_services",
      "description": "Service port: redis (6379)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 6379,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "6379",
          "outbound": "redis-proxy"
        }
      ],
      "expected": {
        "outbound": "redis-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_032",
      "category": "port_services",
      "description": "Service port: http-alt (8080)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 8080,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8080",
          "outbound": "http-alt-proxy"
        }
      ],
      "expected": {
        "outbound": "http-alt-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_033",
      "category": "port_services",
      "description": "Service port: https-alt (8443)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 8443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8443",
          "outbound": "https-alt-proxy"
        }
      ],
      "expected": {
        "outbound": "https-alt-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_034",
      "category": "port_services",
      "description": "Service port: php-fpm (9000)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 9000,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "9000",
          "outbound": "php-fpm-proxy"
        }
      ],
      "expected": {
        "outbound": "php-fpm-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_035",
      "category": "port_services",
      "description": "Service port: prometheus (9090)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 9090,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "9090",
          "outbound": "prometheus-proxy"
        }
      ],
      "expected": {
        "outbound": "prometheus-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "port_service_036",
      "category": "port_services",
      "description": "Service port: mongodb (27017)",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 27017,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "27017",
          "outbound": "mongodb-proxy"
        }
      ],
      "expected": {
        "outbound": "mongodb-proxy",
        "match_type": "rule"
      }
    },
    {
      "id": "combined_domain_port_001",
      "category": "combined_rules",
      "description": "Domain suffix + specific port",
      "input": {
        "domain": "api.example.com",
        "dest_ip": null,
        "dest_port": 8443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example.com",
          "port": "8443",
          "outbound": "api-proxy"
        }
      ],
      "expected": {
        "outbound": "api-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_multi_domain_001",
      "category": "combined_rules",
      "description": "Multiple domain rule types",
      "input": {
        "domain": "cdn.google.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_keyword",
          "target": "cdn",
          "outbound": "cdn-proxy"
        },
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "google-proxy"
        }
      ],
      "expected": {
        "outbound": "cdn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_ip_protocol_001",
      "category": "combined_rules",
      "description": "IP CIDR + UDP protocol",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 53,
        "protocol": "udp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.8.0/24",
          "protocol": "udp",
          "outbound": "dns-proxy"
        }
      ],
      "expected": {
        "outbound": "dns-proxy",
        "match_type": "geoip"
      }
    },
    {
      "id": "combined_complex_001",
      "category": "combined_complex",
      "description": "Complex rule chain #1",
      "input": {
        "domain": "service0.example.com",
        "dest_ip": "10.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service0.example.com",
          "outbound": "service0-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "443",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service0-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_002",
      "category": "combined_complex",
      "description": "Complex rule chain #2",
      "input": {
        "domain": "service1.example.com",
        "dest_ip": "10.0.1.1",
        "dest_port": 444,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service1.example.com",
          "outbound": "service1-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.1.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "444",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service1-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_003",
      "category": "combined_complex",
      "description": "Complex rule chain #3",
      "input": {
        "domain": "service2.example.com",
        "dest_ip": "10.0.2.1",
        "dest_port": 445,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service2.example.com",
          "outbound": "service2-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.2.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "445",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service2-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_004",
      "category": "combined_complex",
      "description": "Complex rule chain #4",
      "input": {
        "domain": "service3.example.com",
        "dest_ip": "10.0.3.1",
        "dest_port": 446,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service3.example.com",
          "outbound": "service3-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.3.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "446",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service3-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_005",
      "category": "combined_complex",
      "description": "Complex rule chain #5",
      "input": {
        "domain": "service4.example.com",
        "dest_ip": "10.0.4.1",
        "dest_port": 447,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service4.example.com",
          "outbound": "service4-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.4.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "447",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service4-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_006",
      "category": "combined_complex",
      "description": "Complex rule chain #6",
      "input": {
        "domain": "service5.example.com",
        "dest_ip": "10.0.5.1",
        "dest_port": 448,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service5.example.com",
          "outbound": "service5-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.5.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "448",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service5-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_007",
      "category": "combined_complex",
      "description": "Complex rule chain #7",
      "input": {
        "domain": "service6.example.com",
        "dest_ip": "10.0.6.1",
        "dest_port": 449,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service6.example.com",
          "outbound": "service6-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.6.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "449",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service6-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_008",
      "category": "combined_complex",
      "description": "Complex rule chain #8",
      "input": {
        "domain": "service7.example.com",
        "dest_ip": "10.0.7.1",
        "dest_port": 450,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service7.example.com",
          "outbound": "service7-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.7.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "450",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service7-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_009",
      "category": "combined_complex",
      "description": "Complex rule chain #9",
      "input": {
        "domain": "service8.example.com",
        "dest_ip": "10.0.8.1",
        "dest_port": 451,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service8.example.com",
          "outbound": "service8-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.8.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "451",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service8-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_010",
      "category": "combined_complex",
      "description": "Complex rule chain #10",
      "input": {
        "domain": "service9.example.com",
        "dest_ip": "10.0.9.1",
        "dest_port": 452,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service9.example.com",
          "outbound": "service9-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.9.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "452",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service9-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_011",
      "category": "combined_complex",
      "description": "Complex rule chain #11",
      "input": {
        "domain": "service10.example.com",
        "dest_ip": "10.0.10.1",
        "dest_port": 453,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service10.example.com",
          "outbound": "service10-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.10.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "453",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service10-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_012",
      "category": "combined_complex",
      "description": "Complex rule chain #12",
      "input": {
        "domain": "service11.example.com",
        "dest_ip": "10.0.11.1",
        "dest_port": 454,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service11.example.com",
          "outbound": "service11-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.11.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "454",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service11-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_013",
      "category": "combined_complex",
      "description": "Complex rule chain #13",
      "input": {
        "domain": "service12.example.com",
        "dest_ip": "10.0.12.1",
        "dest_port": 455,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service12.example.com",
          "outbound": "service12-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.12.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "455",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service12-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_014",
      "category": "combined_complex",
      "description": "Complex rule chain #14",
      "input": {
        "domain": "service13.example.com",
        "dest_ip": "10.0.13.1",
        "dest_port": 456,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service13.example.com",
          "outbound": "service13-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.13.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "456",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service13-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_015",
      "category": "combined_complex",
      "description": "Complex rule chain #15",
      "input": {
        "domain": "service14.example.com",
        "dest_ip": "10.0.14.1",
        "dest_port": 457,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service14.example.com",
          "outbound": "service14-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.14.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "457",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service14-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_016",
      "category": "combined_complex",
      "description": "Complex rule chain #16",
      "input": {
        "domain": "service15.example.com",
        "dest_ip": "10.0.15.1",
        "dest_port": 458,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service15.example.com",
          "outbound": "service15-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.15.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "458",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service15-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_017",
      "category": "combined_complex",
      "description": "Complex rule chain #17",
      "input": {
        "domain": "service16.example.com",
        "dest_ip": "10.0.16.1",
        "dest_port": 459,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service16.example.com",
          "outbound": "service16-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.16.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "459",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service16-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_018",
      "category": "combined_complex",
      "description": "Complex rule chain #18",
      "input": {
        "domain": "service17.example.com",
        "dest_ip": "10.0.17.1",
        "dest_port": 460,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service17.example.com",
          "outbound": "service17-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.17.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "460",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service17-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_019",
      "category": "combined_complex",
      "description": "Complex rule chain #19",
      "input": {
        "domain": "service18.example.com",
        "dest_ip": "10.0.18.1",
        "dest_port": 461,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service18.example.com",
          "outbound": "service18-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.18.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "461",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service18-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "combined_complex_020",
      "category": "combined_complex",
      "description": "Complex rule chain #20",
      "input": {
        "domain": "service19.example.com",
        "dest_ip": "10.0.19.1",
        "dest_port": 462,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "service19.example.com",
          "outbound": "service19-proxy"
        },
        {
          "type": "ip_cidr",
          "target": "10.0.19.0/24",
          "outbound": "private"
        },
        {
          "type": "port",
          "target": "462",
          "outbound": "default"
        }
      ],
      "expected": {
        "outbound": "service19-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "negative_suffix_001",
      "category": "negative_suffix",
      "description": "Should NOT match suffix: notagoogle.com vs google.com",
      "input": {
        "domain": "notagoogle.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_suffix_002",
      "category": "negative_suffix",
      "description": "Should NOT match suffix: notfacebook.com vs facebook.com",
      "input": {
        "domain": "notfacebook.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "facebook.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_suffix_003",
      "category": "negative_suffix",
      "description": "Should NOT match suffix: mamazon.com vs amazon.com",
      "input": {
        "domain": "mamazon.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_suffix_004",
      "category": "negative_suffix",
      "description": "Should NOT match suffix: mapple.com vs apple.com",
      "input": {
        "domain": "mapple.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "apple.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_suffix_005",
      "category": "negative_suffix",
      "description": "Should NOT match suffix: notmicrosoft.com vs microsoft.com",
      "input": {
        "domain": "notmicrosoft.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "microsoft.com",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_cidr_001",
      "category": "negative_cidr",
      "description": "Should NOT match CIDR: 11.0.0.1 vs 10.0.0.0/8",
      "input": {
        "domain": null,
        "dest_ip": "11.0.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "10.0.0.0/8",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_cidr_002",
      "category": "negative_cidr",
      "description": "Should NOT match CIDR: 172.32.0.1 vs 172.16.0.0/12",
      "input": {
        "domain": null,
        "dest_ip": "172.32.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "172.16.0.0/12",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_cidr_003",
      "category": "negative_cidr",
      "description": "Should NOT match CIDR: 192.169.0.1 vs 192.168.0.0/16",
      "input": {
        "domain": null,
        "dest_ip": "192.169.0.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "192.168.0.0/16",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_cidr_004",
      "category": "negative_cidr",
      "description": "Should NOT match CIDR: 8.8.9.1 vs 8.8.8.0/24",
      "input": {
        "domain": null,
        "dest_ip": "8.8.9.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "8.8.8.0/24",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_cidr_005",
      "category": "negative_cidr",
      "description": "Should NOT match CIDR: 1.1.2.1 vs 1.1.1.0/24",
      "input": {
        "domain": null,
        "dest_ip": "1.1.2.1",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "ip_cidr",
          "target": "1.1.1.0/24",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_port_001",
      "category": "negative_port",
      "description": "Should NOT match port: 79 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 79,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_port_002",
      "category": "negative_port",
      "description": "Should NOT match port: 444 vs 80-443",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 444,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "80-443",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_port_003",
      "category": "negative_port",
      "description": "Should NOT match port: 999 vs 1000-2000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 999,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1000-2000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_port_004",
      "category": "negative_port",
      "description": "Should NOT match port: 2001 vs 1000-2000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 2001,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "1000-2000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_port_005",
      "category": "negative_port",
      "description": "Should NOT match port: 7999 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 7999,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_port_006",
      "category": "negative_port",
      "description": "Should NOT match port: 9001 vs 8000-9000",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 9001,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "port",
          "target": "8000-9000",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_protocol_001",
      "category": "negative_protocol",
      "description": "Should NOT match protocol: udp vs tcp",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "udp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "tcp",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "negative_protocol_002",
      "category": "negative_protocol",
      "description": "Should NOT match protocol: tcp vs udp",
      "input": {
        "domain": null,
        "dest_ip": "8.8.8.8",
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "protocol",
          "target": "udp",
          "outbound": "proxy"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "stress_many_rules_first_001",
      "category": "stress_test",
      "description": "50 rules, match first",
      "input": {
        "domain": "www.example0.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example0.com",
          "outbound": "proxy0"
        },
        {
          "type": "domain_suffix",
          "target": "example1.com",
          "outbound": "proxy1"
        },
        {
          "type": "domain_suffix",
          "target": "example2.com",
          "outbound": "proxy2"
        },
        {
          "type": "domain_suffix",
          "target": "example3.com",
          "outbound": "proxy3"
        },
        {
          "type": "domain_suffix",
          "target": "example4.com",
          "outbound": "proxy4"
        },
        {
          "type": "domain_suffix",
          "target": "example5.com",
          "outbound": "proxy5"
        },
        {
          "type": "domain_suffix",
          "target": "example6.com",
          "outbound": "proxy6"
        },
        {
          "type": "domain_suffix",
          "target": "example7.com",
          "outbound": "proxy7"
        },
        {
          "type": "domain_suffix",
          "target": "example8.com",
          "outbound": "proxy8"
        },
        {
          "type": "domain_suffix",
          "target": "example9.com",
          "outbound": "proxy9"
        },
        {
          "type": "domain_suffix",
          "target": "example10.com",
          "outbound": "proxy10"
        },
        {
          "type": "domain_suffix",
          "target": "example11.com",
          "outbound": "proxy11"
        },
        {
          "type": "domain_suffix",
          "target": "example12.com",
          "outbound": "proxy12"
        },
        {
          "type": "domain_suffix",
          "target": "example13.com",
          "outbound": "proxy13"
        },
        {
          "type": "domain_suffix",
          "target": "example14.com",
          "outbound": "proxy14"
        },
        {
          "type": "domain_suffix",
          "target": "example15.com",
          "outbound": "proxy15"
        },
        {
          "type": "domain_suffix",
          "target": "example16.com",
          "outbound": "proxy16"
        },
        {
          "type": "domain_suffix",
          "target": "example17.com",
          "outbound": "proxy17"
        },
        {
          "type": "domain_suffix",
          "target": "example18.com",
          "outbound": "proxy18"
        },
        {
          "type": "domain_suffix",
          "target": "example19.com",
          "outbound": "proxy19"
        },
        {
          "type": "domain_suffix",
          "target": "example20.com",
          "outbound": "proxy20"
        },
        {
          "type": "domain_suffix",
          "target": "example21.com",
          "outbound": "proxy21"
        },
        {
          "type": "domain_suffix",
          "target": "example22.com",
          "outbound": "proxy22"
        },
        {
          "type": "domain_suffix",
          "target": "example23.com",
          "outbound": "proxy23"
        },
        {
          "type": "domain_suffix",
          "target": "example24.com",
          "outbound": "proxy24"
        },
        {
          "type": "domain_suffix",
          "target": "example25.com",
          "outbound": "proxy25"
        },
        {
          "type": "domain_suffix",
          "target": "example26.com",
          "outbound": "proxy26"
        },
        {
          "type": "domain_suffix",
          "target": "example27.com",
          "outbound": "proxy27"
        },
        {
          "type": "domain_suffix",
          "target": "example28.com",
          "outbound": "proxy28"
        },
        {
          "type": "domain_suffix",
          "target": "example29.com",
          "outbound": "proxy29"
        },
        {
          "type": "domain_suffix",
          "target": "example30.com",
          "outbound": "proxy30"
        },
        {
          "type": "domain_suffix",
          "target": "example31.com",
          "outbound": "proxy31"
        },
        {
          "type": "domain_suffix",
          "target": "example32.com",
          "outbound": "proxy32"
        },
        {
          "type": "domain_suffix",
          "target": "example33.com",
          "outbound": "proxy33"
        },
        {
          "type": "domain_suffix",
          "target": "example34.com",
          "outbound": "proxy34"
        },
        {
          "type": "domain_suffix",
          "target": "example35.com",
          "outbound": "proxy35"
        },
        {
          "type": "domain_suffix",
          "target": "example36.com",
          "outbound": "proxy36"
        },
        {
          "type": "domain_suffix",
          "target": "example37.com",
          "outbound": "proxy37"
        },
        {
          "type": "domain_suffix",
          "target": "example38.com",
          "outbound": "proxy38"
        },
        {
          "type": "domain_suffix",
          "target": "example39.com",
          "outbound": "proxy39"
        },
        {
          "type": "domain_suffix",
          "target": "example40.com",
          "outbound": "proxy40"
        },
        {
          "type": "domain_suffix",
          "target": "example41.com",
          "outbound": "proxy41"
        },
        {
          "type": "domain_suffix",
          "target": "example42.com",
          "outbound": "proxy42"
        },
        {
          "type": "domain_suffix",
          "target": "example43.com",
          "outbound": "proxy43"
        },
        {
          "type": "domain_suffix",
          "target": "example44.com",
          "outbound": "proxy44"
        },
        {
          "type": "domain_suffix",
          "target": "example45.com",
          "outbound": "proxy45"
        },
        {
          "type": "domain_suffix",
          "target": "example46.com",
          "outbound": "proxy46"
        },
        {
          "type": "domain_suffix",
          "target": "example47.com",
          "outbound": "proxy47"
        },
        {
          "type": "domain_suffix",
          "target": "example48.com",
          "outbound": "proxy48"
        },
        {
          "type": "domain_suffix",
          "target": "example49.com",
          "outbound": "proxy49"
        }
      ],
      "expected": {
        "outbound": "proxy0",
        "match_type": "domain"
      }
    },
    {
      "id": "stress_many_rules_last_001",
      "category": "stress_test",
      "description": "50 rules, match last",
      "input": {
        "domain": "www.example49.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example0.com",
          "outbound": "proxy0"
        },
        {
          "type": "domain_suffix",
          "target": "example1.com",
          "outbound": "proxy1"
        },
        {
          "type": "domain_suffix",
          "target": "example2.com",
          "outbound": "proxy2"
        },
        {
          "type": "domain_suffix",
          "target": "example3.com",
          "outbound": "proxy3"
        },
        {
          "type": "domain_suffix",
          "target": "example4.com",
          "outbound": "proxy4"
        },
        {
          "type": "domain_suffix",
          "target": "example5.com",
          "outbound": "proxy5"
        },
        {
          "type": "domain_suffix",
          "target": "example6.com",
          "outbound": "proxy6"
        },
        {
          "type": "domain_suffix",
          "target": "example7.com",
          "outbound": "proxy7"
        },
        {
          "type": "domain_suffix",
          "target": "example8.com",
          "outbound": "proxy8"
        },
        {
          "type": "domain_suffix",
          "target": "example9.com",
          "outbound": "proxy9"
        },
        {
          "type": "domain_suffix",
          "target": "example10.com",
          "outbound": "proxy10"
        },
        {
          "type": "domain_suffix",
          "target": "example11.com",
          "outbound": "proxy11"
        },
        {
          "type": "domain_suffix",
          "target": "example12.com",
          "outbound": "proxy12"
        },
        {
          "type": "domain_suffix",
          "target": "example13.com",
          "outbound": "proxy13"
        },
        {
          "type": "domain_suffix",
          "target": "example14.com",
          "outbound": "proxy14"
        },
        {
          "type": "domain_suffix",
          "target": "example15.com",
          "outbound": "proxy15"
        },
        {
          "type": "domain_suffix",
          "target": "example16.com",
          "outbound": "proxy16"
        },
        {
          "type": "domain_suffix",
          "target": "example17.com",
          "outbound": "proxy17"
        },
        {
          "type": "domain_suffix",
          "target": "example18.com",
          "outbound": "proxy18"
        },
        {
          "type": "domain_suffix",
          "target": "example19.com",
          "outbound": "proxy19"
        },
        {
          "type": "domain_suffix",
          "target": "example20.com",
          "outbound": "proxy20"
        },
        {
          "type": "domain_suffix",
          "target": "example21.com",
          "outbound": "proxy21"
        },
        {
          "type": "domain_suffix",
          "target": "example22.com",
          "outbound": "proxy22"
        },
        {
          "type": "domain_suffix",
          "target": "example23.com",
          "outbound": "proxy23"
        },
        {
          "type": "domain_suffix",
          "target": "example24.com",
          "outbound": "proxy24"
        },
        {
          "type": "domain_suffix",
          "target": "example25.com",
          "outbound": "proxy25"
        },
        {
          "type": "domain_suffix",
          "target": "example26.com",
          "outbound": "proxy26"
        },
        {
          "type": "domain_suffix",
          "target": "example27.com",
          "outbound": "proxy27"
        },
        {
          "type": "domain_suffix",
          "target": "example28.com",
          "outbound": "proxy28"
        },
        {
          "type": "domain_suffix",
          "target": "example29.com",
          "outbound": "proxy29"
        },
        {
          "type": "domain_suffix",
          "target": "example30.com",
          "outbound": "proxy30"
        },
        {
          "type": "domain_suffix",
          "target": "example31.com",
          "outbound": "proxy31"
        },
        {
          "type": "domain_suffix",
          "target": "example32.com",
          "outbound": "proxy32"
        },
        {
          "type": "domain_suffix",
          "target": "example33.com",
          "outbound": "proxy33"
        },
        {
          "type": "domain_suffix",
          "target": "example34.com",
          "outbound": "proxy34"
        },
        {
          "type": "domain_suffix",
          "target": "example35.com",
          "outbound": "proxy35"
        },
        {
          "type": "domain_suffix",
          "target": "example36.com",
          "outbound": "proxy36"
        },
        {
          "type": "domain_suffix",
          "target": "example37.com",
          "outbound": "proxy37"
        },
        {
          "type": "domain_suffix",
          "target": "example38.com",
          "outbound": "proxy38"
        },
        {
          "type": "domain_suffix",
          "target": "example39.com",
          "outbound": "proxy39"
        },
        {
          "type": "domain_suffix",
          "target": "example40.com",
          "outbound": "proxy40"
        },
        {
          "type": "domain_suffix",
          "target": "example41.com",
          "outbound": "proxy41"
        },
        {
          "type": "domain_suffix",
          "target": "example42.com",
          "outbound": "proxy42"
        },
        {
          "type": "domain_suffix",
          "target": "example43.com",
          "outbound": "proxy43"
        },
        {
          "type": "domain_suffix",
          "target": "example44.com",
          "outbound": "proxy44"
        },
        {
          "type": "domain_suffix",
          "target": "example45.com",
          "outbound": "proxy45"
        },
        {
          "type": "domain_suffix",
          "target": "example46.com",
          "outbound": "proxy46"
        },
        {
          "type": "domain_suffix",
          "target": "example47.com",
          "outbound": "proxy47"
        },
        {
          "type": "domain_suffix",
          "target": "example48.com",
          "outbound": "proxy48"
        },
        {
          "type": "domain_suffix",
          "target": "example49.com",
          "outbound": "proxy49"
        }
      ],
      "expected": {
        "outbound": "proxy49",
        "match_type": "domain"
      }
    },
    {
      "id": "stress_many_rules_none_001",
      "category": "stress_test",
      "description": "50 rules, no match",
      "input": {
        "domain": "www.notmatched.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "example0.com",
          "outbound": "proxy0"
        },
        {
          "type": "domain_suffix",
          "target": "example1.com",
          "outbound": "proxy1"
        },
        {
          "type": "domain_suffix",
          "target": "example2.com",
          "outbound": "proxy2"
        },
        {
          "type": "domain_suffix",
          "target": "example3.com",
          "outbound": "proxy3"
        },
        {
          "type": "domain_suffix",
          "target": "example4.com",
          "outbound": "proxy4"
        },
        {
          "type": "domain_suffix",
          "target": "example5.com",
          "outbound": "proxy5"
        },
        {
          "type": "domain_suffix",
          "target": "example6.com",
          "outbound": "proxy6"
        },
        {
          "type": "domain_suffix",
          "target": "example7.com",
          "outbound": "proxy7"
        },
        {
          "type": "domain_suffix",
          "target": "example8.com",
          "outbound": "proxy8"
        },
        {
          "type": "domain_suffix",
          "target": "example9.com",
          "outbound": "proxy9"
        },
        {
          "type": "domain_suffix",
          "target": "example10.com",
          "outbound": "proxy10"
        },
        {
          "type": "domain_suffix",
          "target": "example11.com",
          "outbound": "proxy11"
        },
        {
          "type": "domain_suffix",
          "target": "example12.com",
          "outbound": "proxy12"
        },
        {
          "type": "domain_suffix",
          "target": "example13.com",
          "outbound": "proxy13"
        },
        {
          "type": "domain_suffix",
          "target": "example14.com",
          "outbound": "proxy14"
        },
        {
          "type": "domain_suffix",
          "target": "example15.com",
          "outbound": "proxy15"
        },
        {
          "type": "domain_suffix",
          "target": "example16.com",
          "outbound": "proxy16"
        },
        {
          "type": "domain_suffix",
          "target": "example17.com",
          "outbound": "proxy17"
        },
        {
          "type": "domain_suffix",
          "target": "example18.com",
          "outbound": "proxy18"
        },
        {
          "type": "domain_suffix",
          "target": "example19.com",
          "outbound": "proxy19"
        },
        {
          "type": "domain_suffix",
          "target": "example20.com",
          "outbound": "proxy20"
        },
        {
          "type": "domain_suffix",
          "target": "example21.com",
          "outbound": "proxy21"
        },
        {
          "type": "domain_suffix",
          "target": "example22.com",
          "outbound": "proxy22"
        },
        {
          "type": "domain_suffix",
          "target": "example23.com",
          "outbound": "proxy23"
        },
        {
          "type": "domain_suffix",
          "target": "example24.com",
          "outbound": "proxy24"
        },
        {
          "type": "domain_suffix",
          "target": "example25.com",
          "outbound": "proxy25"
        },
        {
          "type": "domain_suffix",
          "target": "example26.com",
          "outbound": "proxy26"
        },
        {
          "type": "domain_suffix",
          "target": "example27.com",
          "outbound": "proxy27"
        },
        {
          "type": "domain_suffix",
          "target": "example28.com",
          "outbound": "proxy28"
        },
        {
          "type": "domain_suffix",
          "target": "example29.com",
          "outbound": "proxy29"
        },
        {
          "type": "domain_suffix",
          "target": "example30.com",
          "outbound": "proxy30"
        },
        {
          "type": "domain_suffix",
          "target": "example31.com",
          "outbound": "proxy31"
        },
        {
          "type": "domain_suffix",
          "target": "example32.com",
          "outbound": "proxy32"
        },
        {
          "type": "domain_suffix",
          "target": "example33.com",
          "outbound": "proxy33"
        },
        {
          "type": "domain_suffix",
          "target": "example34.com",
          "outbound": "proxy34"
        },
        {
          "type": "domain_suffix",
          "target": "example35.com",
          "outbound": "proxy35"
        },
        {
          "type": "domain_suffix",
          "target": "example36.com",
          "outbound": "proxy36"
        },
        {
          "type": "domain_suffix",
          "target": "example37.com",
          "outbound": "proxy37"
        },
        {
          "type": "domain_suffix",
          "target": "example38.com",
          "outbound": "proxy38"
        },
        {
          "type": "domain_suffix",
          "target": "example39.com",
          "outbound": "proxy39"
        },
        {
          "type": "domain_suffix",
          "target": "example40.com",
          "outbound": "proxy40"
        },
        {
          "type": "domain_suffix",
          "target": "example41.com",
          "outbound": "proxy41"
        },
        {
          "type": "domain_suffix",
          "target": "example42.com",
          "outbound": "proxy42"
        },
        {
          "type": "domain_suffix",
          "target": "example43.com",
          "outbound": "proxy43"
        },
        {
          "type": "domain_suffix",
          "target": "example44.com",
          "outbound": "proxy44"
        },
        {
          "type": "domain_suffix",
          "target": "example45.com",
          "outbound": "proxy45"
        },
        {
          "type": "domain_suffix",
          "target": "example46.com",
          "outbound": "proxy46"
        },
        {
          "type": "domain_suffix",
          "target": "example47.com",
          "outbound": "proxy47"
        },
        {
          "type": "domain_suffix",
          "target": "example48.com",
          "outbound": "proxy48"
        },
        {
          "type": "domain_suffix",
          "target": "example49.com",
          "outbound": "proxy49"
        }
      ],
      "expected": {
        "outbound": "direct",
        "match_type": null
      }
    },
    {
      "id": "intl_china_001",
      "category": "international_china",
      "description": "Chinese domain: baidu.com",
      "input": {
        "domain": "baidu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "baidu.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_002",
      "category": "international_china",
      "description": "Chinese domain: qq.com",
      "input": {
        "domain": "qq.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "qq.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_003",
      "category": "international_china",
      "description": "Chinese domain: taobao.com",
      "input": {
        "domain": "taobao.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "taobao.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_004",
      "category": "international_china",
      "description": "Chinese domain: jd.com",
      "input": {
        "domain": "jd.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "jd.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_005",
      "category": "international_china",
      "description": "Chinese domain: weibo.com",
      "input": {
        "domain": "weibo.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "weibo.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_006",
      "category": "international_china",
      "description": "Chinese domain: 163.com",
      "input": {
        "domain": "163.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "163.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_007",
      "category": "international_china",
      "description": "Chinese domain: sohu.com",
      "input": {
        "domain": "sohu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "sohu.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_008",
      "category": "international_china",
      "description": "Chinese domain: sina.com.cn",
      "input": {
        "domain": "sina.com.cn",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "sina.com.cn",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_009",
      "category": "international_china",
      "description": "Chinese domain: tmall.com",
      "input": {
        "domain": "tmall.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "tmall.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_010",
      "category": "international_china",
      "description": "Chinese domain: alipay.com",
      "input": {
        "domain": "alipay.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "alipay.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_011",
      "category": "international_china",
      "description": "Chinese domain: youku.com",
      "input": {
        "domain": "youku.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "youku.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_012",
      "category": "international_china",
      "description": "Chinese domain: iqiyi.com",
      "input": {
        "domain": "iqiyi.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "iqiyi.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_013",
      "category": "international_china",
      "description": "Chinese domain: douyin.com",
      "input": {
        "domain": "douyin.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "douyin.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_014",
      "category": "international_china",
      "description": "Chinese domain: bilibili.com",
      "input": {
        "domain": "bilibili.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "bilibili.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_015",
      "category": "international_china",
      "description": "Chinese domain: zhihu.com",
      "input": {
        "domain": "zhihu.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "zhihu.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_016",
      "category": "international_china",
      "description": "Chinese domain: douban.com",
      "input": {
        "domain": "douban.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "douban.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_017",
      "category": "international_china",
      "description": "Chinese domain: csdn.net",
      "input": {
        "domain": "csdn.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "csdn.net",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_018",
      "category": "international_china",
      "description": "Chinese domain: huawei.com",
      "input": {
        "domain": "huawei.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "huawei.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_019",
      "category": "international_china",
      "description": "Chinese domain: xiaomi.com",
      "input": {
        "domain": "xiaomi.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "xiaomi.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_china_020",
      "category": "international_china",
      "description": "Chinese domain: tencent.com",
      "input": {
        "domain": "tencent.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "tencent.com",
          "outbound": "cn-proxy"
        }
      ],
      "expected": {
        "outbound": "cn-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_001",
      "category": "international_russia",
      "description": "Russian domain: yandex.ru",
      "input": {
        "domain": "yandex.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "yandex.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_002",
      "category": "international_russia",
      "description": "Russian domain: vk.com",
      "input": {
        "domain": "vk.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "vk.com",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_003",
      "category": "international_russia",
      "description": "Russian domain: mail.ru",
      "input": {
        "domain": "mail.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "mail.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_004",
      "category": "international_russia",
      "description": "Russian domain: ok.ru",
      "input": {
        "domain": "ok.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ok.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_005",
      "category": "international_russia",
      "description": "Russian domain: avito.ru",
      "input": {
        "domain": "avito.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "avito.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_006",
      "category": "international_russia",
      "description": "Russian domain: wildberries.ru",
      "input": {
        "domain": "wildberries.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "wildberries.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_007",
      "category": "international_russia",
      "description": "Russian domain: ozon.ru",
      "input": {
        "domain": "ozon.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ozon.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_008",
      "category": "international_russia",
      "description": "Russian domain: tinkoff.ru",
      "input": {
        "domain": "tinkoff.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "tinkoff.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_009",
      "category": "international_russia",
      "description": "Russian domain: sberbank.ru",
      "input": {
        "domain": "sberbank.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "sberbank.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_russia_010",
      "category": "international_russia",
      "description": "Russian domain: gazeta.ru",
      "input": {
        "domain": "gazeta.ru",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "gazeta.ru",
          "outbound": "ru-proxy"
        }
      ],
      "expected": {
        "outbound": "ru-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_001",
      "category": "international_japan",
      "description": "Japanese domain: yahoo.co.jp",
      "input": {
        "domain": "yahoo.co.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "yahoo.co.jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_002",
      "category": "international_japan",
      "description": "Japanese domain: google.co.jp",
      "input": {
        "domain": "google.co.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "google.co.jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_003",
      "category": "international_japan",
      "description": "Japanese domain: amazon.co.jp",
      "input": {
        "domain": "amazon.co.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.co.jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_004",
      "category": "international_japan",
      "description": "Japanese domain: rakuten.co.jp",
      "input": {
        "domain": "rakuten.co.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "rakuten.co.jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_005",
      "category": "international_japan",
      "description": "Japanese domain: livedoor.jp",
      "input": {
        "domain": "livedoor.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "livedoor.jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_006",
      "category": "international_japan",
      "description": "Japanese domain: nicovideo.jp",
      "input": {
        "domain": "nicovideo.jp",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "nicovideo.jp",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_007",
      "category": "international_japan",
      "description": "Japanese domain: pixiv.net",
      "input": {
        "domain": "pixiv.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "pixiv.net",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_008",
      "category": "international_japan",
      "description": "Japanese domain: dmm.com",
      "input": {
        "domain": "dmm.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "dmm.com",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_009",
      "category": "international_japan",
      "description": "Japanese domain: mercari.com",
      "input": {
        "domain": "mercari.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "mercari.com",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_010",
      "category": "international_japan",
      "description": "Japanese domain: line.me",
      "input": {
        "domain": "line.me",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "line.me",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_011",
      "category": "international_japan",
      "description": "Japanese domain: cookpad.com",
      "input": {
        "domain": "cookpad.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cookpad.com",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_012",
      "category": "international_japan",
      "description": "Japanese domain: tabelog.com",
      "input": {
        "domain": "tabelog.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "tabelog.com",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_013",
      "category": "international_japan",
      "description": "Japanese domain: hatenablog.com",
      "input": {
        "domain": "hatenablog.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "hatenablog.com",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_japan_014",
      "category": "international_japan",
      "description": "Japanese domain: fc2.com",
      "input": {
        "domain": "fc2.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "fc2.com",
          "outbound": "jp-proxy"
        }
      ],
      "expected": {
        "outbound": "jp-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_001",
      "category": "international_europe",
      "description": "European domain: bbc.co.uk",
      "input": {
        "domain": "bbc.co.uk",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "bbc.co.uk",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_002",
      "category": "international_europe",
      "description": "European domain: guardian.co.uk",
      "input": {
        "domain": "guardian.co.uk",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "guardian.co.uk",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_003",
      "category": "international_europe",
      "description": "European domain: amazon.co.uk",
      "input": {
        "domain": "amazon.co.uk",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.co.uk",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_004",
      "category": "international_europe",
      "description": "European domain: ebay.co.uk",
      "input": {
        "domain": "ebay.co.uk",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ebay.co.uk",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_005",
      "category": "international_europe",
      "description": "European domain: spiegel.de",
      "input": {
        "domain": "spiegel.de",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "spiegel.de",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_006",
      "category": "international_europe",
      "description": "European domain: amazon.de",
      "input": {
        "domain": "amazon.de",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.de",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_007",
      "category": "international_europe",
      "description": "European domain: otto.de",
      "input": {
        "domain": "otto.de",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "otto.de",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_008",
      "category": "international_europe",
      "description": "European domain: bild.de",
      "input": {
        "domain": "bild.de",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "bild.de",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_009",
      "category": "international_europe",
      "description": "European domain: web.de",
      "input": {
        "domain": "web.de",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "web.de",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_010",
      "category": "international_europe",
      "description": "European domain: lemonde.fr",
      "input": {
        "domain": "lemonde.fr",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "lemonde.fr",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_011",
      "category": "international_europe",
      "description": "European domain: amazon.fr",
      "input": {
        "domain": "amazon.fr",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.fr",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_012",
      "category": "international_europe",
      "description": "European domain: orange.fr",
      "input": {
        "domain": "orange.fr",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "orange.fr",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_013",
      "category": "international_europe",
      "description": "European domain: leboncoin.fr",
      "input": {
        "domain": "leboncoin.fr",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "leboncoin.fr",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_014",
      "category": "international_europe",
      "description": "European domain: elpais.com",
      "input": {
        "domain": "elpais.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "elpais.com",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_015",
      "category": "international_europe",
      "description": "European domain: elmundo.es",
      "input": {
        "domain": "elmundo.es",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "elmundo.es",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_016",
      "category": "international_europe",
      "description": "European domain: amazon.es",
      "input": {
        "domain": "amazon.es",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.es",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_017",
      "category": "international_europe",
      "description": "European domain: corriere.it",
      "input": {
        "domain": "corriere.it",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "corriere.it",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_018",
      "category": "international_europe",
      "description": "European domain: amazon.it",
      "input": {
        "domain": "amazon.it",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "amazon.it",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "intl_europe_019",
      "category": "international_europe",
      "description": "European domain: mediaset.it",
      "input": {
        "domain": "mediaset.it",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "mediaset.it",
          "outbound": "eu-proxy"
        }
      ],
      "expected": {
        "outbound": "eu-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_001",
      "category": "cdn_domains",
      "description": "CDN domain: cloudflare - cloudflare.com",
      "input": {
        "domain": "cloudflare.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cloudflare.com",
          "outbound": "cloudflare-cdn"
        }
      ],
      "expected": {
        "outbound": "cloudflare-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_002",
      "category": "cdn_domains",
      "description": "CDN domain: cloudflare - cloudflare-dns.com",
      "input": {
        "domain": "cloudflare-dns.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cloudflare-dns.com",
          "outbound": "cloudflare-cdn"
        }
      ],
      "expected": {
        "outbound": "cloudflare-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_003",
      "category": "cdn_domains",
      "description": "CDN domain: cloudflare - cdnjs.cloudflare.com",
      "input": {
        "domain": "cdnjs.cloudflare.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cdnjs.cloudflare.com",
          "outbound": "cloudflare-cdn"
        }
      ],
      "expected": {
        "outbound": "cloudflare-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_004",
      "category": "cdn_domains",
      "description": "CDN domain: akamai - akamai.net",
      "input": {
        "domain": "akamai.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "akamai.net",
          "outbound": "akamai-cdn"
        }
      ],
      "expected": {
        "outbound": "akamai-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_005",
      "category": "cdn_domains",
      "description": "CDN domain: akamai - akamaiedge.net",
      "input": {
        "domain": "akamaiedge.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "akamaiedge.net",
          "outbound": "akamai-cdn"
        }
      ],
      "expected": {
        "outbound": "akamai-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_006",
      "category": "cdn_domains",
      "description": "CDN domain: akamai - akamaihd.net",
      "input": {
        "domain": "akamaihd.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "akamaihd.net",
          "outbound": "akamai-cdn"
        }
      ],
      "expected": {
        "outbound": "akamai-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_007",
      "category": "cdn_domains",
      "description": "CDN domain: fastly - fastly.net",
      "input": {
        "domain": "fastly.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "fastly.net",
          "outbound": "fastly-cdn"
        }
      ],
      "expected": {
        "outbound": "fastly-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_008",
      "category": "cdn_domains",
      "description": "CDN domain: fastly - fastlylb.net",
      "input": {
        "domain": "fastlylb.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "fastlylb.net",
          "outbound": "fastly-cdn"
        }
      ],
      "expected": {
        "outbound": "fastly-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_009",
      "category": "cdn_domains",
      "description": "CDN domain: cloudfront - cloudfront.net",
      "input": {
        "domain": "cloudfront.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cloudfront.net",
          "outbound": "cloudfront-cdn"
        }
      ],
      "expected": {
        "outbound": "cloudfront-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_010",
      "category": "cdn_domains",
      "description": "CDN domain: aws - d1.awsstatic.com",
      "input": {
        "domain": "d1.awsstatic.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "d1.awsstatic.com",
          "outbound": "aws-cdn"
        }
      ],
      "expected": {
        "outbound": "aws-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_011",
      "category": "cdn_domains",
      "description": "CDN domain: aws - s3.amazonaws.com",
      "input": {
        "domain": "s3.amazonaws.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "s3.amazonaws.com",
          "outbound": "aws-cdn"
        }
      ],
      "expected": {
        "outbound": "aws-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_012",
      "category": "cdn_domains",
      "description": "CDN domain: azure - azureedge.net",
      "input": {
        "domain": "azureedge.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "azureedge.net",
          "outbound": "azure-cdn"
        }
      ],
      "expected": {
        "outbound": "azure-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_013",
      "category": "cdn_domains",
      "description": "CDN domain: azure - azurefd.net",
      "input": {
        "domain": "azurefd.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "azurefd.net",
          "outbound": "azure-cdn"
        }
      ],
      "expected": {
        "outbound": "azure-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_014",
      "category": "cdn_domains",
      "description": "CDN domain: google - googleusercontent.com",
      "input": {
        "domain": "googleusercontent.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "googleusercontent.com",
          "outbound": "google-cdn"
        }
      ],
      "expected": {
        "outbound": "google-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_015",
      "category": "cdn_domains",
      "description": "CDN domain: google - ggpht.com",
      "input": {
        "domain": "ggpht.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ggpht.com",
          "outbound": "google-cdn"
        }
      ],
      "expected": {
        "outbound": "google-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_016",
      "category": "cdn_domains",
      "description": "CDN domain: google - gstatic.com",
      "input": {
        "domain": "gstatic.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "gstatic.com",
          "outbound": "google-cdn"
        }
      ],
      "expected": {
        "outbound": "google-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_017",
      "category": "cdn_domains",
      "description": "CDN domain: facebook - fbcdn.net",
      "input": {
        "domain": "fbcdn.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "fbcdn.net",
          "outbound": "facebook-cdn"
        }
      ],
      "expected": {
        "outbound": "facebook-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_018",
      "category": "cdn_domains",
      "description": "CDN domain: facebook - fbsbx.com",
      "input": {
        "domain": "fbsbx.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "fbsbx.com",
          "outbound": "facebook-cdn"
        }
      ],
      "expected": {
        "outbound": "facebook-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_019",
      "category": "cdn_domains",
      "description": "CDN domain: twitter - twimg.com",
      "input": {
        "domain": "twimg.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "twimg.com",
          "outbound": "twitter-cdn"
        }
      ],
      "expected": {
        "outbound": "twitter-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_020",
      "category": "cdn_domains",
      "description": "CDN domain: reddit - redd.it",
      "input": {
        "domain": "redd.it",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "redd.it",
          "outbound": "reddit-cdn"
        }
      ],
      "expected": {
        "outbound": "reddit-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_021",
      "category": "cdn_domains",
      "description": "CDN domain: imgur - imgur.com",
      "input": {
        "domain": "imgur.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "imgur.com",
          "outbound": "imgur-cdn"
        }
      ],
      "expected": {
        "outbound": "imgur-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_022",
      "category": "cdn_domains",
      "description": "CDN domain: jsdelivr - jsdelivr.net",
      "input": {
        "domain": "jsdelivr.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "jsdelivr.net",
          "outbound": "jsdelivr-cdn"
        }
      ],
      "expected": {
        "outbound": "jsdelivr-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_023",
      "category": "cdn_domains",
      "description": "CDN domain: unpkg - unpkg.com",
      "input": {
        "domain": "unpkg.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "unpkg.com",
          "outbound": "unpkg-cdn"
        }
      ],
      "expected": {
        "outbound": "unpkg-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "cdn_024",
      "category": "cdn_domains",
      "description": "CDN domain: instagram - cdninstagram.com",
      "input": {
        "domain": "cdninstagram.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "cdninstagram.com",
          "outbound": "instagram-cdn"
        }
      ],
      "expected": {
        "outbound": "instagram-cdn",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_001",
      "category": "gaming_domains",
      "description": "Gaming domain: steam - steampowered.com",
      "input": {
        "domain": "steampowered.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "steampowered.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_002",
      "category": "gaming_domains",
      "description": "Gaming domain: steam - steamcommunity.com",
      "input": {
        "domain": "steamcommunity.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "steamcommunity.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_003",
      "category": "gaming_domains",
      "description": "Gaming domain: steam - steamstatic.com",
      "input": {
        "domain": "steamstatic.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "steamstatic.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_004",
      "category": "gaming_domains",
      "description": "Gaming domain: epic - epicgames.com",
      "input": {
        "domain": "epicgames.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "epicgames.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_005",
      "category": "gaming_domains",
      "description": "Gaming domain: epic - unrealengine.com",
      "input": {
        "domain": "unrealengine.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "unrealengine.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_006",
      "category": "gaming_domains",
      "description": "Gaming domain: ea - ea.com",
      "input": {
        "domain": "ea.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ea.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_007",
      "category": "gaming_domains",
      "description": "Gaming domain: ea - origin.com",
      "input": {
        "domain": "origin.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "origin.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_008",
      "category": "gaming_domains",
      "description": "Gaming domain: blizzard - blizzard.com",
      "input": {
        "domain": "blizzard.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "blizzard.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_009",
      "category": "gaming_domains",
      "description": "Gaming domain: blizzard - battle.net",
      "input": {
        "domain": "battle.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "battle.net",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_010",
      "category": "gaming_domains",
      "description": "Gaming domain: riot - riotgames.com",
      "input": {
        "domain": "riotgames.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "riotgames.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_011",
      "category": "gaming_domains",
      "description": "Gaming domain: riot - leagueoflegends.com",
      "input": {
        "domain": "leagueoflegends.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "leagueoflegends.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_012",
      "category": "gaming_domains",
      "description": "Gaming domain: riot - valorant.com",
      "input": {
        "domain": "valorant.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "valorant.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_013",
      "category": "gaming_domains",
      "description": "Gaming domain: microsoft - minecraft.net",
      "input": {
        "domain": "minecraft.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "minecraft.net",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_014",
      "category": "gaming_domains",
      "description": "Gaming domain: microsoft - xbox.com",
      "input": {
        "domain": "xbox.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "xbox.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_015",
      "category": "gaming_domains",
      "description": "Gaming domain: sony - playstation.com",
      "input": {
        "domain": "playstation.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "playstation.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_016",
      "category": "gaming_domains",
      "description": "Gaming domain: sony - playstation.net",
      "input": {
        "domain": "playstation.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "playstation.net",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_017",
      "category": "gaming_domains",
      "description": "Gaming domain: nintendo - nintendo.com",
      "input": {
        "domain": "nintendo.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "nintendo.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_018",
      "category": "gaming_domains",
      "description": "Gaming domain: nintendo - nintendo.net",
      "input": {
        "domain": "nintendo.net",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "nintendo.net",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_019",
      "category": "gaming_domains",
      "description": "Gaming domain: ubisoft - ubisoft.com",
      "input": {
        "domain": "ubisoft.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "ubisoft.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    },
    {
      "id": "gaming_020",
      "category": "gaming_domains",
      "description": "Gaming domain: rockstar - rockstargames.com",
      "input": {
        "domain": "rockstargames.com",
        "dest_ip": null,
        "dest_port": 443,
        "protocol": "tcp"
      },
      "rules": [
        {
          "type": "domain_suffix",
          "target": "rockstargames.com",
          "outbound": "gaming-proxy"
        }
      ],
      "expected": {
        "outbound": "gaming-proxy",
        "match_type": "domain"
      }
    }
  ]
}